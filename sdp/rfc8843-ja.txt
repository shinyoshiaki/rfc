RFCトランス
プライバシーポリシー
コンタクト
イチジク
@ tex2e
8843
RFC 8843-Session Description Protocol（SDP）日本語訳を使用したメディア多重化のネゴシエーション
URL：https：//tools.ietf.org/html/rfc8843
スクリプト：RFC 8843-セッション記述プロトコル（SDP）を使用したメディア多重化のネゴシエーション
編集編集：自動生成
[検索] [txt | html | xml | pdf | with errata | bibtex] [Tracker] [WG] [Email] [Diff1] [Diff2] [Nits]
        
差出人：draft-ietf-mmusic-sdp-bundle-negotiation-54提案された標準エラッタ存在インターネットエンジニアリングタスクフォース（IETF）C. Holmbergコメントの要求：8843 Ericsson更新：3264、5888、7941 H. Alvestrandカテゴリ：標準トラックGoogle ISSN ：2070-1721 C. Jennings Cisco 2021年1月

セッション記述プロトコル（SDP）を使用したメディア多重化のネゴシエーション

概要

この仕様は、「BUNDLE」と呼ばれる新しいセッション記述プロトコル（SDP）グループ化フレームワーク拡張機能を定義します. この拡張機能をSDPオファー/アンサーメカニズムとともに使用して、複数のSDPメディア記述（ "m ="セクション）で記述されたメディアを送受信するための単一のトランスポート（5タプル）の使用をネゴシエートできます. このようなトランスポートはBUNDLEトランスポートと呼ばれ、メディアはバンドルされたメディアと呼ばれます. BUNDLEトランスポートを使用する "m ="セクションは、BUNDLEグループを形成します. 

この仕様は、新しいRTP制御プロトコル（RTCP）ソース記述（SDES）項目と新しいRTPヘッダー拡張を定義します. 

この仕様は、RFC 3264、5888、および7941を更新します. 

このメモのステータス

これはインターネット標準化過程の文書です. 

このドキュメントは、インターネット技術特別調査委員会（IETF）の製品です. これは、IETFコミュニティのコンセンサスを表しています. パブリックレビューを受け、Internet Engineering Steering Group（IESG）による公開が承認されました. インターネット標準の詳細については、RFC7841のセクション2を参照してください. 

このドキュメントの現在のステータス、正誤表、およびフィードバックの提供方法に関する情報は、https：//www.rfc-editor.org/info/rfc8843で入手できます. 

著作権表示

Copyright（c）2021 IETFTrustおよびドキュメントの作成者として識別された人物. 全著作権所有. 

このドキュメントは、このドキュメントの発行日に有効なBCP 78およびIETFドキュメントに関連するIETFトラストの法的規定（https://trustee.ietf.org/license-info）の対象となります. これらのドキュメントは、このドキュメントに関するあなたの権利と制限を説明しているため、注意深く確認してください. このドキュメントから抽出されたコードコンポーネントには、Trust LegalProvisionsのセクション4.eで説明されているSimplifiedBSD Licenseテキストが含まれている必要があり、Simplified BSDLicenseで説明されているように保証なしで提供されます. 

このドキュメントには、2008年11月10日より前に公開または公開されたIETFドキュメントまたはIETFコントリビューションの資料が含まれている場合があります. この資料の一部の著作権を管理している人は、IETFトラストにそのような資料の変更を許可する権利を付与していない可能性があります.  IETF標準プロセスの外部. そのような資料の著作権を管理する人から適切なライセンスを取得しない限り、このドキュメントをIETF標準プロセスの外部で変更することはできません. また、その派生物をIETF標準プロセスの外部で作成することはできません.  RFCとして公開するか、英語以外の言語に翻訳します. 

Table of Contents

   1.  Introduction
     1.1.  Background
     1.2.  BUNDLE Mechanism
     1.3.  Protocol Extensions
     1.4.  Contradiction regarding bundle-only "m=" sections
   2.  Terminology
   3.  Conventions
   4.  Applicability Statement
   5.  SDP Grouping Framework BUNDLE Extension
   6.  SDP 'bundle-only' Attribute
   7.  SDP Offer/Answer Procedures
     7.1.  Generic SDP Considerations
       7.1.1.  Connection Data ("c=")
       7.1.2.  Bandwidth ("b=")
       7.1.3.  Attributes ("a=")
     7.2.  Generating the Initial SDP Offer
       7.2.1.  Suggesting the Offerer-Tagged 'm=' Section
       7.2.2.  Example: Initial SDP Offer
     7.3.  Generating the SDP Answer
       7.3.1.  Answerer Selection of Tagged 'm=' Sections
       7.3.2.  Moving a Media Description Out of a BUNDLE Group
       7.3.3.  Rejecting a Media Description in a BUNDLE Group
       7.3.4.  Example: SDP Answer
     7.4.  Offerer Processing of the SDP Answer
     7.5.  Modifying the Session
       7.5.1.  Adding a Media Description to a BUNDLE Group
       7.5.2.  Moving a Media Description Out of a BUNDLE Group
       7.5.3.  Disabling a Media Description in a BUNDLE Group
   8.  Protocol Identification
     8.1.  STUN, DTLS, and SRTP
   9.  RTP Considerations
     9.1.  Single RTP Session
       9.1.1.  Payload Type (PT) Value Reuse
     9.2.  Associating RTP/RTCP Streams with the Correct SDP Media
           Description
     9.3.  RTP/RTCP Multiplexing
       9.3.1.  SDP Offer/Answer Procedures
   10. ICE Considerations
   11. DTLS Considerations
   12. RTP Header Extensions Consideration
   13. Update to RFC 3264
     13.1.  Original Text from RFC 3264, Section 5.1, 2nd Paragraph
     13.2.  New Text Replacing RFC 3264, Section 5.1, 2nd Paragraph
     13.3.  Original Text from RFC 3264, Section 8.4, 6th Paragraph
     13.4.  New Text Replacing RFC 3264, Section 8.4, 6th Paragraph
   14. Update to RFC 5888
     14.1.  Original Text from RFC 5888, Section 9.2, 3rd Paragraph
     14.2.  New Text Replacing RFC 5888, Section 9.2, 3rd Paragraph
   15. RTP/RTCP Extensions for identification-tag Transport
     15.1.  RTCP MID SDES Item
     15.2.  RTP SDES Header Extension For MID
   16. IANA Considerations
     16.1.  New SDES Item
     16.2.  New RTP SDES Header Extension URI
     16.3.  New SDP Attribute
     16.4.  New SDP Group Semantics
   17. Security Considerations
   18. Examples
     18.1.  Example: Tagged "m=" Section Selections
     18.2.  Example: BUNDLE Group Rejected
     18.3.  Example: Offerer Adds a Media Description to a BUNDLE
            Group
     18.4.  Example: Offerer Moves a Media Description Out of a BUNDLE
            Group
     18.5.  Example: Offerer Disables a Media Description within a
            BUNDLE Group
   19. References
     19.1.  Normative References
     19.2.  Informative References
   Appendix A.  Design Considerations
     A.1.  UA Interoperability
     A.2.  Usage of Port Number Value Zero
     A.3.  B2BUA and Proxy Interoperability
       A.3.1.  Traffic Policing
       A.3.2.  Bandwidth Allocation
     A.4.  Candidate Gathering
     Acknowledgements
   Authors' Addresses

1.はじめに
1.1. バックグラウンド
SDPオファー/アンサーメカニズム[RFC3264]を使用してマルチメディア通信セッションの確立をネゴシエートする場合、個々のメディアストリームごとに個別のトランスポート（5タプル）をネゴシエートすると、各トランスポートは追加のリソースを消費します（特に、Interactive Connectivity Establishment（ICE ）[RFC8445]が使用されます）. このため、複数のメディアストリームに単一のトランスポートを使用することは魅力的です. 

1.2. バンドルメカニズム
この仕様は、複数のSDPメディア記述（ "m ="セクション）によって記述されたメディア（バンドルされたメディア）を送受信するために単一のトランスポート（BUNDLEトランスポート）を使用する方法を定義します. バンドルされたメディアを送受信するためにエンドポイントによって使用されるアドレス：ポートの組み合わせは、BUNDLEアドレス：ポートと呼ばれます. BUNDLEグループ内の各「m =」セクションに適用されるSDP属性のセットは、BUNDLE属性と呼ばれます. バンドルメディアの送受信には同じBUNDLEトランスポートが使用されます. つまり、RTPベースのバンドルメディアには、対称Real-time Transport Protocol（RTP）メカニズム[RFC4961]が常に使用されます. 

この仕様は、「BUNDLE」と呼ばれる新しいSDP Grouping Framework [RFC5888]拡張機能を定義します. この拡張機能は、Session Description Protocol（SDP）オファー/アンサーメカニズム[RFC3264]で使用して、どの "m ="セクションがBUNDLEグループの一部になるかをネゴシエートできます. さらに、提供者と回答者[RFC3264]は、BUNDLE拡張機能を使用して、BUNDLEアドレス：ポート（提供者BUNDLEアドレス：ポートと回答者BUNDLEアドレス：ポート）および一連のBUNDLE属性（提供者BUNDLE属性と回答者BUNDLE属性）をネゴシエートします.  BUNDLEグループ内の各「m =」セクションに適用されます. 

BUNDLEトランスポートを使用すると、BUNDLEグループ全体でICE [RFC8445]候補の単一セットを使用できます. 

指定されたBUNDLEaddress：portは、単一のBUNDLEグループにのみ関連付けられている必要があります. SDPオファーまたはSDPアンサー（以下「オファー」および「アンサー」と呼びます）に複数のBUNDLEグループが含まれている場合、この仕様の手順は各グループに個別に適用されます. 特定のBUNDLEグループに関連付けられているすべてのRTPベースのバンドルメディアは、単一のRTPセッション[RFC3550]に属しています. 

BUNDLE拡張は後方互換性がある。 この拡張に対応していないエンドポイントは、[RFC3264]と[RFC4566]の手順に従い、SDP「group:BUNDLE」属性なしでオファーとアンサーを生成し、オファーとアンサー内の各「m=」セクションに固有のアドレスとポートを割り当てることが期待されます。

1.3. プロトコル拡張
この仕様では、新しいSDP Grouping Framework拡張機能の定義に加えて、次のプロトコル拡張機能とRFC更新を定義しています. この仕様：

*新しいSDP属性 'bundle-only'を定義します. これは、特定の "m ="セクション（および関連するメディア）がBUNDLEグループ内に保持されている場合にのみ使用されるように要求するために使用できます. 

* RFC 3264 [RFC3264]を更新し、「m =」セクションで記述されたメディアが無効化または拒否されていない場合に、「m =」セクションにゼロポート値を割り当てることもできるようにします. 

*新しいRTCP [RFC3550] SDESアイテム、「MID」、およびRTPストリームを「m =」セクションに関連付けるために使用できる新しいRTPSDESヘッダー拡張を定義します. 

* MID RTPヘッダー拡張のSDESアイテムを運ぶSDESRTPヘッダー拡張の保護に関する要件に、MID RTPヘッダー拡張の例外を追加することにより、[RFC7941]を更新します. 

1.4. バンドルのみの「m =」セクションに関する矛盾
WebRTC仕様文書の承認以来、IETFは、JSEPを指定する文書とBUNDLEを指定する文書（それぞれRFC 8829とこのRFC）の間に矛盾があることに気づきました. 公開をさらに遅らせて解決するのではなく、ドキュメントは最初に承認されたとおりに公開されています. IETFはこれらのテクノロジの作業を再開する予定であり、解決策が利用可能になり次第、これらのドキュメントの改訂版が公​​開されます. 

特定の問題には、[RFC8829]のセクション4.1.1で説明されているように、バンドルのみとして指定された「m =」セクションの処理が含まれます. 現在、JSEPとBUNDLEの間、およびこれらの仕様と既存のブラウザー実装の間には相違があります. 

* JSEPは、「m = "セクションはポート0を使用し、最初のオファーでは「a = bundle-only」属性を追加する必要がありますが、回答や後続のオファーでは追加しないようにする必要がある」と規定しています. 

* BUNDLEは、これらの「m =」セクションは前のポイントで説明したようにマークする必要があると規定していますが、すべてのオファーとアンサーでマークする必要があります. 

*現在のほとんどのブラウザは、「m =」セクションにポート0のマークを付けず、代わりに、バンドルされているすべての「m =」セクションに同じポートを使用します. 他のいくつかはJSEPの振る舞いに従います. 

2.用語
"m ="セクション：SDP本体には、 "m ="セクションと呼ばれる1つ以上のメディア記述が含まれています. 各「m =」セクションは、SDP「m =」行と「m =」行に関連付けられた0個以上のSDP属性で表されます. ローカルアドレス：ポートの組み合わせは、各「m =」セクションに割り当てられます. 

5タプル：次の値のコレクション：送信元アドレス、送信元ポート、宛先アドレス、宛先ポート、およびトランスポート層プロトコル. 

一意のアドレス：ポート：オファーまたはアンサーの1つの「m =」セクションにのみ割り当てられるアドレス：ポートの組み合わせ. 

オファー提供者BUNDLE-tag：オファー内の特定のSDP'group：BUNDLE '属性IDIDタグリストの最初のIDタグ. 

Answerer BUNDLE-tag：特定のSDP'group：BUNDLE '属性の識別タグリストの最初の識別タグ. 

提案された提供者タグ付き「m =」セクション：BUNDLEグループがネゴシエートされる前に、最初のBUNDLEオファーで提供者BUNDLEタグによって識別されたバンドルされた「m =」セクション. 

提供者タグ付き「m =」セクション：後続のオファーで提供者BUNDLEタグによって識別されるバンドルされた「m =」セクション. "m ="セクションには、BUNDLEグループ内の各 "m ="セクションに適用される特性（offer BUNDLE address：portおよびoffer BUNDLE属性）が含まれています. 

回答者タグ付きの「m =」セクション：回答内の回答者BUNDLEタグによって識別されるバンドルされた「m =」セクション（最初のBUNDLE回答以降）. 「m =」セクションには、BUNDLEグループ内の各「m =」セクションに適用される特性（アンサーBUNDLEアドレス：ポートおよびアンサーBUNDLE属性）が含まれています. 

バンドルアドレス：ポート：エンドポイントがバンドルメディアの送受信に使用するアドレス：ポートの組み合わせ. 

提供者バンドルアドレス：ポート：メディアの送受信に提供者が使用するアドレス：ポートの組み合わせ. 

Answerer BUNDLE address：port：メディアを送受信するためにAnswererが使用するアドレス：ポートの組み合わせ. 

BUNDLE属性：IDENTICALおよびTRANSPORT多重化カテゴリーSDP属性. BUNDLEグループが作成されると、属性値はBUNDLEグループ内のバンドルされた各「m =」セクションに適用されます. 

提供者バンドル属性：提供者タグ付きの「m =」セクションに含まれるIDENTICALおよびTRANSPORT多重化カテゴリSDP属性. 

Answerer BUNDLE属性：Answererタグ付きの「m =」セクションに含まれるIDENTICALおよびTRANSPORT多重化カテゴリSDP属性. 

BUNDLEトランスポート：BUNDLEグループ内の「m =」セクションで記述されているすべてのメディアで使用されるトランスポート（5タプル）. 

BUNDLEグループ：SDPオファー/アンサー交換を使用して作成されたバンドルされた「m =」セクションのセット. 単一のBUNDLEトランスポートと、単一のBUNDLE属性のセットを使用して、によって記述されたすべてのメディア（バンドルされたメディア）を送受信します.  「m =」セクションのセット. バンドルされたメディアの送受信には、同じBUNDLEトランスポートが使用されます. 

バンドルされた「m =」セクション：「m =」セクション. その識別タグは、オファーまたはアンサーのSDP'group：BUNDLE '属性識別タグリストに配置されます. 

バンドルのみの「m =」セクション：SDPの「バンドルのみ」属性を含むバンドルされた「m =」セクション. 

バンドルメディア：特定のBUNDLEグループに関連付けられているすべてのメディア. 

最初のBUNDLEオファー：SDPセッション内の最初のオファー（たとえば、SIP [RFC3261]がSDPの伝送に使用される場合のSIPダイアログ）. オファー提供者は、特定のBUNDLEグループをネゴシエートすることを示します. 

最初のBUNDLE回答：最初のBUNDLEオファーに対する回答で、提供者がBUNDLEグループのネゴシエーションを希望していることを示し、回答者がBUNDLEグループの作成を受け入れます. BUNDLEグループは、回答者が最初のBUNDLE回答を送信すると作成されます. 

後続のオファー：以前のオファー/アンサー交換の一部として作成されたBUNDLEグループを含むオファー. 

後続の回答：後続のオファーに対する回答. 

識別タグ：「m =」セクションを識別するために使用される一意のトークン値. 「m =」セクションのSDP「mid」属性[RFC5888]には、その「m =」セクションに割り当てられた一意の識別タグが付いています. セッションレベルのSDP「グループ」属性[RFC5888]は、特定の「グループ」属性に関連付けられた「m =」セクションを識別する識別タグのリストを保持します. 

3.コンベンション
キーワード「MUST」、「MUST NOT」、「REQUIRED」、「SHALL」、「SHALL NOT」、「SHOULD」、「SHOULD NOT」、「RECOMMENDED」、「NOT RECOMMENDED」、「MAY」、「OPTIONAL」 「このドキュメントでは、BCP 14 [RFC2119] [RFC8174]で説明されているように、ここに示すように、すべて大文字で表示される場合にのみ解釈されます. 

4.適用性ステートメント
この仕様のメカニズムは、SDPオファー/アンサーメカニズム[RFC3264]と一緒に使用される場合、SDP [RFC4566]にのみ適用されます. SDPの宣言的な使用法はこのドキュメントの範囲外であるため、定義されていません. 

5.SDPグループ化フレームワークバンドル拡張
このセクションでは、新しいSDPグループ化フレームワーク[RFC5888]拡張機能「BUNDLE」を定義します. BUNDLE拡張機能をSDPオファー/アンサーメカニズムとともに使用して、BUNDLEグループの一部となる一連の「m =」セクションをネゴシエートできます. BUNDLEグループ内では、各「m =」セクションは、バンドルされたメディアの送受信にBUNDLEトランスポートを使用します. 各エンドポイントは、バンドルされたメディアを送受信するために単一のアドレスとポートの組み合わせを使用します. 

BUNDLE拡張は、セマンティクス値[RFC5888]が "BUNDLE"のSDP'group '属性を使用して示されます. バンドルされた各「m =」セクションに識別タグが割り当てられ、各識別タグはSDPの「group：BUNDLE」属性の識別タグリストにリストされます. 識別タグが識別タグリストにリストされている各「m =」セクションは、特定のBUNDLEグループに関連付けられています. 

SDP本体には、複数のBUNDLEグループを含めることができます. 特定のバンドルされた「m =」セクションは、常に複数のバンドルグループに関連付けられてはなりません（MUSTNOT）. 

注：SDPの「group：BUNDLE」属性識別タグリストにリストされている「m =」セクションの順序は、SDPで「m =」セクションが出現する順序と同じである必要はありません. 

'group：BUNDLE'属性の多重化カテゴリ[RFC8859]は 'NORMAL'です. 

セクション7は、BUNDLE拡張機能の詳細なSDPオファー/アンサー手順を定義します. 

6. SDP 'バンドルのみ'属性
このセクションでは、新しいSDPメディアレベル属性[RFC4566]、「バンドルのみ」を定義します. 'bundle-only'はプロパティ属性[RFC4566]であるため、値はありません. 

BUNDLE拡張機能をサポートしない回答者が、オファー内のバンドルされた「m =」セクションを常に拒否するようにするために、オファー提供者は「m =」セクションにゼロポート値を割り当てることができます. [RFC3264]によると、回答者はそのような「m =」セクションを拒否します. バンドルされた「m =」セクションにSDP「bundle-only」属性を含めることにより、提供者は、回答者がBUNDLE拡張機能をサポートし、回答者が「m =」を保持する場合にのみ、回答者が「m =」セクションを受け入れるように要求できます. 関連するBUNDLEグループ内の "セクション. 

名前：バンドルのみ

値：N / A

使用レベル：メディア

文字セットに依存：いいえ

例：a = bundle-only

提供者タグ付きの「m =」セクションと回答者タグ付きの「m =」セクションが選択されると、提供者と回答者はSDPの「バンドルのみ」属性をに含め、他のすべてにゼロポート値を割り当てます. バンドルされた「m =」セクション. 

'bundle-only'属性の使用法は、ポート値がゼロのバンドルされた "m ="セクションに対してのみ定義されます. その他の使用法は指定されていません. 

セクション7は、「バンドルのみ」属性の詳細なSDPオファー/アンサー手順を定義します. 

7.SDPオファー/回答手順
このセクションでは、以下のSDPオファー/アンサー[RFC3264]の手順について説明します. 

* BUNDLEグループの交渉. 

*タグ付きの "m ="セクション（offer-tagged "m ="セクションとanswerer-tagged "m ="セクション）の提案と選択）;

*「m =」セクションをBUNDLEグループに追加します. 

*「m =」セクションをBUNDLEグループから移動します. と

* BUNDLEグループ内の「m =」セクションを無効にします. 

[RFC3264]および[RFC5888]で定義されている一般的なルールと手順は、BUNDLE拡張機能にも適用されます. たとえば、オファーがアンサーによって拒否された場合、以前にネゴシエートされたアドレス：ポート、SDPパラメータ、および特性（BUNDLEグループに関連付けられているものを含む）が適用されます. したがって、オファー側がBUNDLEグループをネゴシエートするためにオファーを生成し、アンサー側がオファーを拒否した場合、BUNDLEグループは作成されません. 

このセクションの手順は、バンドルされた「m =」セクションに割り当てられたメディアタイプまたは「m =」ラインプロト値とは無関係です. セクション6では、SDPの「バンドルのみ」属性の使用に関する追加の考慮事項を定義します. セクション9では、RTPベースのメディアに関する追加の考慮事項を定義しています. セクション10では、ICE [RFC8445]メカニズムの使用に関する追加の考慮事項を定義しています. 

オファーとアンサーには、複数のBUNDLEグループを含めることができます. このセクションの手順は、特定のBUNDLEグループに個別に適用されます. 

7.1. 一般的なSDPの考慮事項
このセクションでは、BUNDLEグループ内でのSDPパラメーターの使用に関連する一般的な制限について説明します. また、バンドルされた各「m =」セクションにパラメーターと属性の値が割り当てられている場合に、BUNDLEグループ全体の値を計算する方法についても説明します. 

7.1.1. 接続データ（ "c ="）
バンドルされた「m =」セクションに関連付けられた「c =」ラインネットタイプ値[RFC4566]は「IN」でなければなりません. 

バンドルされた「m =」セクションに関連付けられた「c =」行addrtype値[RFC4566]は、「IP4」または「IP6」でなければなりません. 同じ値を各「m =」セクションに関連付ける必要があります. 

注：この仕様の拡張により、上記以外のnettypeおよびaddrtype値に対するBUNDLEメカニズムの使用法を指定できます. 

7.1.2. 帯域幅（ "b ="）
提供者と回答者は、[RFC8859]で定義されているルールと制限を使用して、SDP帯域幅（ "b ="）行をバンドルされた "m ="セクションに関連付ける必要があります. 

7.1.3. 属性（ "a ="）
提供者と回答者は、以下の例外を除いて、各属性の通常の提供/回答手順に従って、該当する場合はすべてのバンドルされた「m =」セクションにSDP属性を含める必要があります. 

*最初のBUNDLEオファーでは、オファー提供者は、バンドルのみの「m =」セクションにIDENTICALおよびTRANSPORT多重化カテゴリーSDP属性（BUNDLE属性）を含めてはなりません（MUSTNOT）. 提供者は、他のすべてのバンドルされた「m =」セクションにそのような属性を含める必要があります. 最初のBUNDLEオファーでは、バンドルされた各「m =」行に、異なるBUNDLE属性と属性値のセットを含めることができます. 提供者タグ付きの「m =」セクションが選択されると、提供者タグ付きの「m =」セクションに含まれるBUNDLE属性が、BUNDLEグループ内のバンドルされた各「m =」セクションに適用されます. 

*後続のオファー、または回答（後続のイニシャル）では、提供者と回答者は、タグ付きの「m =」セクション（オファータグ付きの「m =」）にのみIDENTICALおよびTRANSPORT多重化カテゴリSDP属性（BUNDLE属性）を含める必要があります. セクションまたは回答者タグ付きの「m =」セクション）. 提供者と回答者は、他のバンドルされた「m =」セクションにそのような属性を含めてはなりません（MUSTNOT）. タグ付きの「m =」セクションに含まれるBUNDLE属性は、BUNDLEグループ内のバンドルされた各「m =」セクションに適用されます. 

*オファー（最初のBUNDLEオファー以降）またはアンサー（最初のBUNDLEアンサー以降）では、オファー側とアンサー側は、指定されたバンドルされた各「m =」セクションに、IDENTICALおよびTRANSPORT以外のカテゴリーのSDP属性を含める必要があります. 属性はに適用されます. バンドルされた各 "m ="行には、そのような属性と属性値の異なるセットを含めることができます. そのような属性は、それらが含まれる特定のバンドルされた "m ="セクションにのみ適用されるためです. 

注：上記のルールの結果として、BUNDLEグループ内のバンドルされた「m =」セクションの一部にのみ適用されるメディア固有のIDENTICALおよびTRANSPORT多重化カテゴリSDP属性が、タグ付けされた「m =」セクションに表示される場合があります. それらは適用されません. たとえば、タグ付けされた「m =」セクションにRTPベースのメディアが記述されていない場合でも、タグ付けされた「m =」セクションにSDP「rtcp-mux」属性が含まれる場合があります（ただし、BUNDLEグループ内の別のバンドルされた「m =」セクションには記述されていますRTPベースのメディアについて説明します）. 

7.2. 最初のSDPオファーの生成
このセクションの手順は、SDPセッション内の最初のオファー（たとえば、SIP [RFC3261]を使用してSDPを伝送する場合のSIPダイアログ）に適用されます. このオファーでは、オファー側が特定のBUNDLEグループをネゴシエートすることを示します. これは、SDPセッションの最初のオファーまたは後続のオファーで発生する可能性があります. 

提供者が最初のBUNDLEオファーを生成するとき、BUNDLEグループをネゴシエートするには、次のことを行う必要があります. 

* [RFC3264]の手順に従って、バンドルされた各「m =」セクションに一意のaddress：portを割り当てます. ただし、バンドルのみの「m =」セクションは除きます（以下を参照）. 

*バンドルされた「m =」セクションを提案者タグ付き「m =」として選択します（セクション7.2.1）. 

*セクション7.1.3のルールに従って、バンドルされた「m =」セクションにSDP属性を含めます. 

*オファーにSDP'group：BUNDLE '属性を含めます. と

*バンドルされている各「m =」セクションの識別タグをSDP'group：BUNDLE '属性の識別タグリストに配置します. 提供者のBUNDLEタグは、提案された提供者のタグが付いた「m =」セクションを示します. 

注：提供者が一意のアドレス：ポートを複数のバンドルされた「m =」セクションに割り当てる場合、提供者は、関連する回答を受け取り、どのバンドルされた「m =」を見つけるまで、各一意のアドレス：ポートでバンドルされたメディアを受信できるように準備する必要があります.  "セクション（および関連するアドレス：ポートの組み合わせ）は、回答者が提供者タグ付きの" m = "セクションとして選択しました. 

提供者が、ネゴシエートされたBUNDLEグループ内に「m =」セクションを保持している場合にのみ、回答者が特定のバンドルされた「m =」セクションを受け入れるように要求する場合、提供者は次のことを行う必要があります. 

*「m =」セクションにSDPの「バンドルのみ」属性（セクション7.2.1）を含め、

*「m =」セクションにゼロポート値を割り当てます. 

注：提供者がバンドルされた「m =」セクションにゼロポート値を割り当てているが、「m =」セクションにSDPの「バンドルのみ」属性が含まれていない場合、提供者が無効にすることを望んでいることを示します.  "m ="セクション（セクション7.5.3）. 

セクション7.2.2および18.1は、最初のバンドルオファーの例を示しています. 

7.2.1. 提供者タグ付きの「m =」セクションの提案
最初のBUNDLEオファーでは、提供者のBUNDLEタグによって示されるバンドルされた「m =」セクションは、提案された提供者タグ付きの「m =」セクションです. 「m =」セクションに関連付けられたアドレス：ポートの組み合わせは、回答者が「m =」セクションを提供者タグ付きの「m =」セクションとして選択した場合に、バンドルされたメディアを送受信するために提供者によって使用されます（セクション7.3.1 ）. さらに、回答者が提供者タグ付きの「m =」セクションとして「m =」セクションを選択した場合、「m =」セクションに含まれるBUNDLE属性は、ネゴシエートされたBUNDLEグループ内の各「m =」セクションに適用されます.  . 

提供者は、提供者がタグ付けした「m =」セクションとして、バンドルのみの「m =」セクションを提案してはなりません. 

提案された提供者タグ付きの「m =」セクションは、回答者がBUNDLEグループから拒否または移動する可能性が低いと提供者が信じるバンドルされた「m =」セクションであることが推奨されます. このような仮定がどのように行われるかは、このドキュメントの範囲外です. 

7.2.2. 例：最初のSDPオファー
この例は、最初のBUNDLEオファーを示しています. オファーには2つの「m =」セクションが含まれており、両方の「m =」セクションがBUNDLEグループに含まれていることを示しています. オーディオ「m =」セクションは、提案されたオファータグ付きの「m =」セクションであり、「m =」セクションに関連付けられた識別タグ（オファーBUNDLEタグ）をSDPグループの最初に配置することによって示されます：BUNDLE属性の識別- IDリスト. 

SDPオファー

     v = 0
     o = alice 2890844526 2890844526 IN IP6 2001：db8 :: 3
     s =
     c = IN IP6 2001：db8 :: 3
     t = 0 0
     a = group：BUNDLE foo bar
        
     m = audio 10000 RTP / AVP 0 8 97
     b = AS：200
     a = mid：foo
     a = rtcp-mux
     a = rtpmap：0 PCMU / 8000
     a = rtpmap：8 PCMA / 8000
     a = rtpmap：97 iLBC / 8000
     a = extmap：1 urn：ietf：params：rtp-hdrext：sdes：mid
        
     m =ビデオ10002RTP / AVP 31 32
     b = AS：1000
     a = mid：bar
     a = rtcp-mux
     a = rtpmap：31 H261 / 90000
     a = rtpmap：32 MPV / 90000
     a = extmap：1 urn：ietf：params：rtp-hdrext：sdes：mid
        
7.3. SDP回答の生成
回答者がBUNDLEグループを含む回答（最初のBUNDLE回答以降）を生成する場合、[RFC5888]で定義されている次の一般的なSDPグループ化フレームワークの制限がBUNDLEグループにも適用されます. 

*回答者は、提供者が対応する最初のBUNDLEオファーでBUNDLEグループを作成するように要求した場合にのみ、最初のBUNDLE回答にBUNDLEグループを含めることができます. 

*回答者は、対応する後続のオファーに以前にネゴシエートされたBUNDLEグループが含まれている場合にのみ、後続の回答にBUNDLEグループを含めることができます. 

*回答者は、対応するオファーで「m =」セクションがバンドルされていると示された場合にのみ、バンドルされた「m =」セクションを回答に含めることができます. と

*回答者は、対応するオファーのバンドルされた「m =」行と同じBUNDLEグループにバンドルされた「m =」セクションのみを含めることができます. 

さらに、回答者がBUNDLEグループを含む回答（最初のBUNDLE回答以降）を生成する場合、回答者は次のことを行う必要があります. 

*最初のBUNDLE回答の場合は、セクション7.3.1の手順を使用して、提供者がタグ付けした「m =」セクションを選択します. 後続の回答の場合、提供者がタグ付けした「m =」セクションは、対応する後続の提案に示され、回答者が変更してはなりません. 

*回答者がタグ付けした「m =」セクションを選択します（セクション7.3.1）. 

*アンサーのBUNDLEaddress：portをアンサータグ付きの「m =」セクションに割り当てます. 

* SDPの「bundle-only」属性をBUNDLEグループ内の他のすべてのバンドルされた「m =」セクションに含め、ゼロポート値を割り当てます. 

*セクション7.1.3のルールに従って、バンドルされた「m =」セクションにSDP属性を含めます. 

*回答にSDP'group：BUNDLE '属性を含めます. と

*バンドルされている各「m =」セクションの識別タグをSDP'group：BUNDLE '属性の識別タグリストに配置します. 回答者のBUNDLEタグは、回答者がタグ付けした「m =」セクションを示します（セクション7.3.1）. 

回答者がBUNDLEグループ内に「m =」セクションを保持したくない場合は、次のことを行う必要があります. 

*「m =」セクションをBUNDLEグループから移動します（セクション7.3.2）. また

*「m =」セクションを拒否します（セクション7.3.3）. 

回答者は、回答者のBUNDLE address：portを変更したり、SDP属性を追加および削除したり、後続の回答でSDP属性値を変更したりできます. アンサーBUNDLEaddress：portおよびアンサーBUNDLE属性への変更は、BUNDLEグループ内のバンドルされた各「m =」セクションに適用されます. 

注：オファーのバンドルされた「m =」セクションにゼロポート値が含まれているが、「m =」セクションにSDPの「バンドルのみ」属性が含まれていない場合は、オファー提供者が「 m = "セクション（セクション7.5.3）. 

7.3.1. タグ付きの「m =」セクションの回答者の選択
提供者がタグ付けした「m =」セクションを選択する場合、回答者は最初に「m =」セクションが次の基準セクション7.2.1を満たしているかどうかを確認する必要があります. 

*回答者は「m =」セクションをBUNDLEグループから移動しません（セクション7.3.2）. 

*回答者は「m =」セクション（セクション7.3.3）を拒否しません. と

*「m =」セクションにはゼロポート値は含まれていません. 

上記のすべての基準が満たされている場合、回答者は「m =」セクションを提供者タグ付きの「m =」セクションとして選択し、回答内の対応する「m =」セクションを回答者タグ付きの「m」としてマークする必要があります.  = "セクション. 回答では、回答者のBUNDLEタグは、回答者がタグ付けされた「m =」セクションを示します. 

1つ以上の基準が満たされていない場合、回答者はオファーの識別タグリストで次の識別タグを選択し、その識別タグで示される「m =」セクションに対して同じ基準チェックを実行する必要があります. 識別タグリストに識別タグがもうない場合、回答者はBUNDLEグループを作成してはなりません（MUSTNOT）. 回答者がオファー全体を拒否しない限り、回答者は、「m =」セクションをBUNDLEグループから移動する（セクション7.3.2）か、「m =」セクションをBUNDLEグループ内で拒否する（セクション7.3）ための回答者手順を適用する必要があります.  3）回答を作成するときに、オファーにバンドルされているすべての「m =」セクションに. 

セクション18.1は、提供者のバンドルアドレス：ポートの選択の例を示しています. 

セクション7.3.4および18.1は、回答者がタグ付けした「m =」セクション選択の例を示しています. 

7.3.2. メディア記述をバンドルグループから移動する
回答者が回答を生成するときに、回答者がバンドルされた「m =」セクションをネゴシエートされたBUNDLEグループから移動したい場合、回答者は最初に次の基準を確認する必要があります. 

*対応するオファーでは、「m =」セクションは以前にネゴシエートされたBUNDLEグループ内にあり、

*対応するオファーでは、「m =」セクションにSDPの「バンドルのみ」属性が含まれています. 

上記のいずれかの基準が満たされている場合、回答者は回答のBUNDLEグループから「m =」セクションを移動できません. 回答者は、オファー全体を拒否するか、BUNDLEグループ内のバンドルされた各「m =」セクションを拒否するか（セクション7.3.3）、回答のBUNDLEグループ内の「m =」セクションを保持して、後で「 m = "セクションはBUNDLEグループから移動されました（セクション7.5.2）. 

注：上記のルールの結果の1つは、BUNDLEグループがネゴシエートされると、バンドルされた「m =」セクションを回答のBUNDLEグループから移動できないことです. 代わりに、オファーが必要です. 

回答者が回答を生成し、バンドルされた「m =」セクションをBUNDLEグループから移動すると、回答者は次のようになります. 

*「m =」セクションに一意のaddress：portを割り当てる必要があります. 

*各属性の通常のオファー/アンサー手順を使用して、「m =」セクションに該当するSDP属性を含める必要があります. 

*「m =」セクションに関連付けられた識別タグをSDP'group：BUNDLE '属性の識別タグリストに配置してはなりません. BUNDLEグループに関連付けられています. と

*「m =」セクションにSDPの「バンドルのみ」属性を含めてはなりません（MUSTNOT）. 

回答者は回答内のあるBUNDLEグループから別のBUNDLEグループに「m =」セクションを移動することは許可されていないため（セクション7.3）、回答者が「m =」セクションをあるBUNDLEグループから別のグループに移動したい場合は、最初に「m =」セクションを移動する必要があります.  「m =」セクションを現在のBUNDLEグループから移動してから、「m =」セクションが別のBUNDLEグループに追加されるオファーを生成します（セクション7.5.1）. 

7.3.3. バンドルグループでのメディア記述の拒否
回答者が回答にバンドルされている「m =」セクションを拒否する場合は、最初に次の基準を確認する必要があります. 

*対応するオファーでは、「m =」セクションはオファー者がタグ付けした「m =」セクションです. 

上記の基準が満たされている場合、回答者は回答の「m =」セクションを拒否できません. 回答者は、オファー全体を拒否するか、BUNDLEグループ内のバンドルされた各「m =」セクションを拒否するか、回答のBUNDLEグループ内の「m =」セクションを保持して、後で「m =」セクションが無効になっているオファーを作成できます.  BUNDLEグループ内（セクション7.5.3）. 

回答者が回答を生成し、バンドルされた「m =」セクションを拒否すると、回答者は次のようになります. 

* [RFC3264]の手順に従って、「m =」セクションにゼロポート値を割り当てなければなりません. 

*「m =」セクションに関連付けられた識別タグをSDP'group：BUNDLE '属性の識別タグリストに配置してはなりません. BUNDLEグループに関連付けられています. と

*「m =」セクションにSDPの「バンドルのみ」属性を含めてはなりません（MUSTNOT）. 

7.3.4. 例：SDP回答
以下の例は、セクション7.2.2の対応するオファーに基づく回答を示しています. 回答者は、作成されたBUNDLEグループ内の両方のバンドルされた「m =」セクションを受け入れます. 音声の「m =」セクションは、回答者がタグ付けした「m =」セクションであり、「m =」セクションに関連付けられた識別タグ（回答者のBUNDLEタグ）をSDPグループの最初に配置することで示されます. BUNDLE属性の識別IDリスト. 回答者は、SDPの「バンドルのみ」属性をビデオ「m =」セクションに含め、ゼロポート値を割り当てます. 

SDP回答

     v = 0
     o = bob 2808844564 2808844564 IN IP6 2001：db8 :: 1
     s =
     c = IN IP6 2001：db8 :: 1
     t = 0 0
     a = group：BUNDLE foo bar
        
     m = audio 20000 RTP / AVP 0
     b = AS：200
     a = mid：foo
     a = rtcp-mux
     a = rtpmap：0 PCMU / 8000
     a = extmap：1 urn：ietf：params：rtp-hdrext：sdes：mid
        
     m =ビデオ0RTP / AVP 32
     b = AS：1000
     a = mid：bar
     a =バンドルのみ
     a = rtpmap：32 MPV / 90000
     a = extmap：1 urn：ietf：params：rtp-hdrext：sdes：mid
        
7.4. SDP回答の提供者処理
提供者が回答を受け取ったときに、回答にBUNDLEグループが含まれている場合、提供者は、回答にバンドルされている「m =」セクションが対応するオファーにバンドルされていることを示していることを確認する必要があります. 不一致がない場合、提供者は、提供者がタグ付けした「m =」セクション（回答者が選択. セクション7.3.1を参照）のプロパティ（BUNDLEアドレス：ポート、BUNDLE属性など）を各バンドルに適用する必要があります.  BUNDLEグループ内のm = "セクション. 

注：回答者は、最初のBUNDLEオファーで1つ以上のバンドルされた「m =」セクションを拒否したり、バンドルされた「m =」セクションをバンドルグループから移動したりする可能性があるため、オファー内の特定のバンドルされた「m =」セクションはそうではない場合があります対応する回答にバンドルされていると示されます. 

回答にBUNDLEグループが含まれていない場合、提供者は回答を通常の回答として処理する必要があります. 

7.5. セッションの変更
BUNDLEグループが以前にネゴシエートされており、提供者が後続の提案を生成する場合、提供者は次のことを行う必要があります. 

*提供者がタグ付けした「m =」セクションとして、バンドルされている「m =」セクションを1つ選択します. 提供者は、以前に回答者によって提供者タグ付きの「m =」セクションとして選択された「m =」セクション、またはBUNDLEグループ内の別のバンドルされた「m =」セクションのいずれかを選択できます. 

* BUNDLE address：port（以前にネゴシエートされたまたは新しく提案された）を提供者タグ付きの「m =」セクションに割り当てます. 

* SDPの「bundle-only」属性をBUNDLEグループ内の他のすべてのバンドルされた「m =」セクションに含め、ゼロポート値を割り当てます. 

*セクション7.1.3のルールに従って、バンドルされた「m =」セクションにSDP属性を含めます. 

*オファーにSDP'group：BUNDLE '属性を含めます. と

*バンドルされている各「m =」セクションの識別タグをSDP'group：BUNDLE '属性の識別タグリストに配置します. 提供者のBUNDLEタグは、提供者がタグ付けした「m =」セクションを示します. 

次の場合、提供者は、特定のバンドルされた「m =」セクションを提供者タグ付きの「m =」セクションとして選択してはなりません. 

*提供者は、「m =」セクションをBUNDLEグループ（セクション7.5.2）から移動したい、または

*提供者は、「m =」セクションを無効にしたいと考えています（セクション7.5.3）. 

提供者は、提供者のBUNDLE address：portを変更したり、SDP属性を追加および削除したり、後続のオファーでSDP属性値を変更したりできます. 提供者のBUNDLEaddress：portおよび提供者のBUNDLE属性への変更は、（オファーが回答者によって受け入れられた場合）BUNDLEグループ内のバンドルされた各「m =」セクションに適用されます. 

7.5.1. バンドルグループへのメディアの説明の追加
提供者が、以前にネゴシエートされたBUNDLEグループにバンドルされた「m =」セクションを追加する後続のオファーを生成する場合、提供者はセクション7.5の手順に従います. 提供者は、追加された「m =」セクション、または以前にBUNDLEグループに追加された「m =」セクションのいずれかを提供者タグ付きの「m =」セクションとして選択します. 

注：セクション7.3.2で説明されているように、回答者は、追加された「m =」セクションを回答のBUNDLEグループから移動することはできません. 回答が「m =」セクションをBUNDLEグループから移動したい場合は、最初に回答のBUNDLEグループに受け入れてから、「m =」セクションが移動された後続のオファーを送信する必要があります.  BUNDLEグループ（セクション7.5.2）. 

7.5.2. メディア記述をバンドルグループから移動する
オファー側が後続のオファーを生成し、バンドルされた「m =」セクションをBUNDLEグループから削除する場合、オファー側は次のようになります. 

*「m =」セクションに一意のaddress：portを割り当てる必要があります. 

*各属性の通常のオファー/アンサールールに従って、「m =」セクションにSDP属性を含める必要があります. 

*「m =」セクションに関連付けられた識別タグをSDP'group：BUNDLE '属性の識別タグリストに配置してはなりません. BUNDLEグループに関連付けられています. と

*「m =」セクションにSDPの「バンドルのみ」属性を割り当ててはなりません（MUSTNOT）. 

BUNDLEグループ内の他のバンドルされた「m =」セクションの場合、提供者はセクション7.5の手順に従います. 

オファー提供者は、単一のオファー内で「m =」セクションを1つのバンドルグループから別のグループに移動してはなりません. 提供者が「m =」セクションをあるBUNDLEグループから別のグループに移動する場合は、最初にBUNDLEグループを現在のBUNDLEグループから移動してから、「m =」セクションが別のグループに追加される2番目のオファーを生成する必要があります. バンドルグループ（セクション7.5.1）. 

セクション18.4は、「m =」セクションをBUNDLEグループから移動するためのオファーの例を示しています. 

7.5.3. バンドルグループでのメディア記述の無効化
オファー側が後続のオファーを生成し、BUNDLEグループからバンドルされた「m =」セクションを無効にする場合、オファー側は次のようになります. 

* [RFC4566]の手順に従って、「m =」セクションにゼロポート値を割り当てなければなりません. 

*「m =」セクションに関連付けられた識別タグをSDP'group：BUNDLE '属性の識別タグリストに配置してはなりません. BUNDLEグループに関連付けられています. と

*「m =」セクションにSDPの「バンドルのみ」属性を割り当ててはなりません（MUSTNOT）. 

BUNDLEグループ内の他のバンドルされた「m =」セクションの場合、提供者はセクション7.5の手順に従います. 

セクション18.5は、BUNDLEグループ内の「m =」セクションを無効にするためのオファーと回答の例を示しています. 

8.プロトコルの識別
BUNDLEグループ内の各「m =」セクションは、同じトランスポート層プロトコルを使用する必要があります. バンドルされた「m =」セクションがトランスポート層プロトコルの上に異なる上位層プロトコルを使用する場合、メカニズムが受信データをこの特定のプロトコルの組み合わせの正しいプロトコルに関連付ける方法を説明する公に利用可能な仕様が存在する必要があります. 

さらに、受信データを複数のバンドルされた「m =」セクションに関連付けることができる場合、受信データを正しい「m =」セクションに関連付けるメカニズムを説明する公開されている仕様が存在する必要があります. 

このドキュメントでは、UDPをトランスポート層として使用する場合に、NAT（STUN）、DTLS、およびSecure Real-time Transport Protocol（SRTP）（任意の組み合わせ）のSession TraversalUtilities間で受信データのプロトコルを識別するメカニズムについて説明します. プロトコルですが、DTLSで転送されるさまざまなプロトコルを識別する方法については説明していません. このメカニズムは一般に他のプロトコルやトランスポート層プロトコルに適用できますが、そのような使用には、特定のトランスポート層プロトコルで複数のプロトコルを多重化する方法と、受信したデータを正しいプロトコルに関連付ける方法を含む詳細な仕様が必要です. 

8.1. STUN、DTLS、およびSRTP
[RFC5764]のセクション5.1.2では、STUN、DTLS、およびSRTPプロトコル（任意の組み合わせ）の中から受信パケットのプロトコルを識別するメカニズムについて説明しています. オファーまたはアンサーにこれらのプロトコルを表すバンドルされた「m =」セクションが含まれている場合、オファー側またはアンサー側は[RFC5764]で説明されているメカニズムをサポートする必要があり、メカニズムのサポートと使用法を示すために明示的なネゴシエーションは必要ありません. 

[RFC5764]は、DTLSで転送されるさまざまなプロトコルを識別する方法については説明しておらず、DTLSプロトコル自体を識別する方法についてのみ説明しています. 複数のプロトコルがDTLSで転送される場合、個々のプロトコルを識別するためのメカニズムを説明する仕様が存在する必要があります. さらに、受信したDTLSパケットを複数の「m =」セクションに関連付けることができる場合、受信したDTLSパケットを正しい「m =」セクションに関連付けるメカニズムを説明する仕様が存在する必要があります. 

セクション9.2では、受信したSRTPストリーム内のパケットを正しい「m =」セクションに関連付ける方法について説明します. 

9.RTPに関する考慮事項
9.1. シングルRTPセッション
単一のBUNDLEグループ内のすべてのRTPベースのメディアは、単一のRTPセッション[RFC3550]に属します. 

バンドルされたメディアの送受信には単一のBUNDLEトランスポートが使用されるため、RTPベースのバンドルされたメディアには対称RTPメカニズム[RFC4961]を使用する必要があります. 

単一のRTPセッションが各BUNDLEグループに使用されるため、BUNDLEグループ内のRTPベースのメディアを表すすべての「m =」セクションは、単一の同期ソース（SSRC）番号付けスペース[RFC3550]を共有します. 

次のルールと制限が単一のRTPセッションに適用されます. 

*特定のペイロードタイプ値は、ペイロードタイプ番号に関連付けられた各コーデックが同一のコーデック構成を共有する場合にのみ、複数のバンドルされた「m =」セクションで使用できます（セクション9.1.1）. 

*バンドルされている各RTPベースの「m =」セクションのプロト値は同一である必要があります（たとえば、RTP / AVPF）. 

* RTP MIDヘッダー拡張は、バンドルされた各RTPベースの「m」に「urn：ietf：params：rtp-hdrext：sdes：mid」URI値を持つSDP「extmap」属性[RFC8285]を含めることによって有効にする必要があります= "すべてのオファーと回答のセクション. 

*特定のSSRCは、バンドルされたさまざまな「m =」セクションから発信されたペイロードタイプを使用してRTPパケットを送信してはなりません（MUSTNOT）. 

注：上記の最後の箇条書きは、同じSSRCから複数のメディアタイプを送信しないようにするためのものです. 複数のメディアタイプの送信が時間の重複で行われる場合、RTPとRTCPは機能しません. 適切な順序で実行された場合でも、これによりRTPタイムスタンプレートスイッチングの問題が発生します[RFC7160]. ただし、SSRCが（RTCP BYEパケットを送信することによって）RTPセッションを離れると、そのSSRCは、5つのRTCPレポート間隔（遅延は、RTCP BYEパケットが失われた場合にSSRCがタイムアウトしたことを確認するためのものです[RFC3550]）. 

[RFC7657]は、Diffservコードポイントの混合を使用して送信されるRTPベースのバンドルメディアに対するDifferentiated Services（Diffserv）の考慮事項を定義しています. 

9.1.1. ペイロードタイプ（PT）値の再利用
複数のバンドルされた「m =」セクションは、RTPベースのメディアを説明する場合があります. BUNDLEグループに関連付けられたすべてのRTPベースのメディアは同じRTPセッションに属しているため、特定のペイロードタイプ値を複数のバンドルされた「m =」セクション内で使用するには、ペイロードタイプ番号に関連付けられたすべてのコーデックが共有する必要があります同一のコーデック構成. これは、コーデックが同じメディアタイプ、エンコーディング名、クロックレート、およびコーデックの構成とパケット化に影響を与える可能性のあるパラメータを共有する必要があることを意味します. [RFC8859]は、同じペイロードタイプ値を使用するすべてのコーデックで属性値が同一である必要があるSDP属性を一覧表示します. 

9.2. RTP / RTCPストリームを正しいSDPメディアの説明に関連付ける

[RFC3550]で説明されているように、RTPパケットはRTPストリーム[RFC7656]に関連付けられています. 各RTPストリームはSSRC値によって識別され、各RTPパケットには、パケットを正しいRTPストリームに関連付けるために使用されるSSRCフィールドが含まれています. RTCPパケットは、SSRCを使用して、パケットが関連するRTPストリームを識別します. ただし、RTCPパケットには、さまざまなRTPストリームに関するフィードバックまたはレポートを提供する過程で、複数のSSRCフィールドを含めることができるため、そのような複数のストリームに関連付けることができます. 

受信したRTP / RTCPパケットを正しく処理できるようにするには、RTPストリームを正しい「m =」セクションに関連付けることができなければなりません. これは、「m =」セクションと「m =」セクションに関連付けられたSDP属性です. パケットの処理に必要な情報が含まれています. 

BUNDLEグループに関連付けられたすべてのRTPストリームは、RTP / RTCPパケットの送受信に同じトランスポートを使用するため、トランスポートのローカルアドレス：ポートの組み合わせ部分を使用して、RTPストリームを正しい「m =」セクションに関連付けることはできません. さらに、複数のRTPストリームが同じ「m =」セクションに関連付けられている場合があります. 

提供者と回答者は、SDPの「ssrc」属性[RFC5576]を使用して、RTPストリームに使用するSSRC値を相互に通知できます. ただし、提供者は、その情報を提供する回答を受け取るまで、回答者が使用するSSRC値を知りません. このため、提供者が回答を受け取る前に、提供者は、RTPストリームに関連付けられたSSRC値を使用して、RTPストリームを正しい「m =」セクションに関連付けることができません. さらに、提供者と回答者は、SDPの「ssrc」属性の使用について互いに通知することなく、セッションの途中で新しいSSRC値の使用を開始できます. 

提供者と回答者が常にRTPストリームを正しい「m =」セクションに関連付けることができるようにするには、BUNDLE拡張機能を使用する提供者と回答者は、セクション15で定義されたメカニズムをサポートする必要があります.  -BUNDLEグループに関連付けられたRTPおよびRTCPパケットへの「m =」セクション（リモートピアによって提供される）に関連付けられたタグ. 

このメカニズムを使用する場合、SSRCから識別タグへのマッピングは、セクション15で指定されているように、RTPヘッダー拡張またはRTCP SDESパケットで実行されます. 複合RTCPパケットには、複数のRTCP SDESパケットを含めることができ、各RTCPSDESパケットには複数のチャンクを含む場合、単一のRTCPパケットにSSRCからIDタグへの複数のマッピングを含めることができます. 提供者と回答者は、ルーティングに使用されるテーブルを維持します. このテーブルは、RTP / RTCPパケットに、パケットのルーティング方法に影響を与える新しい情報が含まれるたびに更新されます. 

ただし、一部のレガシー実装では、BUNDLEメカニズムを使用する場合、RTPおよびRTCPトラフィックにこの識別タグが含まれず、代わりにペイロードタイプに基づくメカニズムを使用してRTPストリームをSDP "m ="セクションに関連付けます. この状況では、ペイロードタイプがRTPストリームに関連する「m =」セクションの信頼できるインジケータであるために、各「m =」セクションは一意のペイロードタイプ値を使用する必要があります. 実装が一意のペイロードタイプ値を保証できない場合、そのペイロードタイプ値を使用してRTPストリームを特定の「m =」セクションに関連付けることはできません. ペイロードタイプを使用してRTPストリームを「m =」セクションに関連付ける場合、SSRCによって識別されるRTPストリームは「m =」にマップされることに注意してください. そのRTPストリームの最初のパケットが受信されたときのセクションであり、そのRTPストリームで使用されるペイロードタイプが変更されても、マッピングは変更されません. つまり、SSRCは、ペイロードタイプを変更するだけでは、別の「m =」セクションに「移動」することはできません. 

アプリケーションは、さまざまな方法でRTPスタックを実装できます. 以下のアルゴリズムは、RTPストリームを「m =」セクションに関連付けることができる1つの方法を詳しく説明していますが、RTPスタックをどのように実装する必要があるかを正確に規定することを意図したものではありません. アプリケーションは、以下のアルゴリズムで説明されているものと同等の結果を達成する任意のアルゴリズムを使用できます（MAY）. 

RTPストリームを正しい「m =」セクションに関連付ける準備をするには、BUNDLEグループごとに次の手順を実行する必要があります. 

*このBUNDLEグループの「m =」セクションごとにMIDを「m =」セクションにマッピングするテーブルを作成します. 「m =」セクションにはMIDが1つしかないことに注意してください. 

*着信RTPストリームのSSRCを、このBUNDLEグループの各 "m ="セクション、およびその "m ="セクションで受信するように構成された各SSRCの "m ="セクションにマッピングするテーブルを作成します. 

*各発信RTPストリームのSSRCを、このBUNDLEグループの各「m =」セクションおよびその「m =」セクションで送信するように構成された各SSRCの「m =」セクションにマッピングするテーブルを作成します. 

* BUNDLEグループの各 "m ="セクション、およびその "m ="セクションで受信するように構成された各ペイロードタイプについて、ペイロードタイプを "m ="セクションにマッピングするテーブルを作成します. ペイロードタイプがBUNDLEグループの複数の「m =」セクションで受信するように構成されている場合は、「m =」セクションを一意に識別するために使用できないため、テーブルに含めないでください. 

*これらのテーブルごとに、特定のキー（MID、SSRC、またはPT）に対して1つのマッピングしか存在できないことに注意してください. つまり、テーブルはマルチマップではありません. 

「m =」セクションがBUNDLEグループに追加または削除されたり、それらの構成が変更されたりすると、上記のテーブルも更新する必要があります. 

RTPパケットを受信すると、SSRCに対応するRTPストリームに配信される必要があります. そのRTPストリームは、次の手順に従って、追加の処理のために、BUNDLEグループ内の正しい「m =」セクションに関連付けられている必要があります. 

* RTPストリームに関連付けられたMIDが、MIDを「m =」セクションにマッピングするテーブルにない場合、RTPストリームはデコードされず、ペイロードデータは破棄されます. 

*パケットにMIDがあり、パケットの拡張シーケンス番号が最後のMID更新のシーケンス番号よりも大きい場合、[RFC7941]のセクション4.2.2で説明されているように、RTPストリームに関連付けられたMIDを更新して、伝送されたMIDと一致させます.  RTPパケットを更新してから、マッピングテーブルを更新して、そのRTPストリームのSSRCをそのMIDの「m =」セクションにマッピングするエントリを含めます. 

* RTPストリームのSSRCが着信SSRCマッピングテーブルにある場合は、RTPストリームで使用されるペイロードタイプが、一致する「m =」セクションに含まれるペイロードタイプと一致することを確認してください. その場合、RTPストリームをその「m =」セクションに関連付けます. それ以外の場合、RTPストリームはデコードされず、ペイロードデータは破棄されます. 

* RTPストリームで使用されるペイロードタイプがペイロードタイプテーブルにある場合は、着信SSRCマッピングテーブルを更新して、RTPストリームのSSRCをそのペイロードタイプの「m =」セクションにマップするエントリを含めます. RTPストリームを対応する「m =」セクションに関連付けます. 

*それ以外の場合は、RTPストリームを「デコード対象外」としてマークし、ペイロードを破棄します. 

RTPパケットに1つ以上のContributingSource（CSRC）IDが含まれている場合、各CSRCは着信SSRCテーブルで検索され、RTPパケットのコピーが対応する「m =」セクションに関連付けられて追加の処理が行われます. 

受信した各RTCPパケット（複合RTCPパケットの一部である各RTCPパケットを含む）について、パケットは通常どおりRTP層によって処理され、適切な「m =」セクションに関連付けられ、で表されるRTPストリームに対して処理されます. それらの「m =」セクション. 各種類のRTCPパケットには、関連するRTPストリームに関連付けるための独自のメカニズムがあるため、このルーティングはタイプに依存します. 

適切な「m =」セクションに関連付けることができないRTCPパケットは、対応するRTPストリームに関連付けられたメタデータを更新するRTPレイヤーによって通常どおり処理される必要があります. この状況は、特定のマルチパーティRTPトポロジで、またはSDES情報のサブセットを含むRTCPパケットが送信されるときに発生する可能性があります. 

さまざまなタイプのRTCPパケットを処理するための追加のルールを以下に説明します. 

* RTCPパケットのタイプがSDESの場合、着信SSRCテーブルでSSRCが見つかったパケットのチャンクごとに、SDESパケットのコピーをそのSSRCに関連付けられた「m =」セクションに配信します. さらに、これらのチャンクに含まれるSDES MIDアイテムについて、MIDを「m =」セクションにマッピングするテーブルでMIDが見つかった場合は、着信SSRCテーブルを更新して、チャンクに関連付けられたRTPストリームをマッピングするエントリを含めます.  [RFC7941]のセクション4.2.6で説明されているように、パケットがこのSSRCのマッピングを最後に更新したパケットよりも古い場合を除き、そのMIDに関連付けられた「m =」セクションへのSSRC. 

* SDESパケットが複合RTCPパケットの一部として受信された場合、SSRCから「m =」へのセクションマッピングは、SDESパケットが処理されるまで存在しない可能性があることに注意してください（たとえば、送信元のRTCPが受信される前にRTPパケット）. したがって、実装がRTCPパケットルーティングを遅延させることは有益であり、SDESアイテムの処理を優先してマッピングを生成または更新するか、SDESアイテムがルーティングされるまでルーティングする必要のあるRTCP情報をバッファリングします. 処理されました. 実装がこの推奨事項に従わない場合、結果として、この特定のRTCP複合パケットからの一部のRTCP情報が上位層に提供されない可能性があります. この情報が将来の着信RTPストリームに関連する場合、これによる影響はわずかである可能性があります. 

* RTCPパケットのタイプがBYEの場合、パケットで参照されているRTPストリームが終了していることを示します. したがって、着信SSRCテーブルにあるパケットに示されている各SSRCについて、最初にBYEパケットのコピーをそのSSRCに関連付けられた「m =」セクションに配信し、次にそのSSRCのエントリを着信SSRCから削除します.  [RFC3550]のセクション6.2.1で指定されているように、「ストラグラーパケット」を説明するための適切な遅延後のテーブル. 

* RTCPパケットのタイプが送信者レポート（SR）または受信者レポート（RR）の場合、送信SSRCテーブルで「送信元のSSRC」が見つかったレポートのレポートブロックごとに、SRまたはRRパケットのコピーを配信します. そのSSRCに関連付けられている「m =」セクションに移動します. さらに、パケットのタイプがSRであり、パケットの送信側SSRCが着信SSRCテーブルにある場合は、SRパケットのコピーをそのSSRCに関連付けられた「m =」セクションに配信します. 

*実装がRTCP拡張レポート（XR）をサポートし、パケットが[RFC3611]で定義されているようにタイプXRである場合、送信SSRCテーブルで「ソースのSSRC」が見つかったレポートのレポートブロックごとに、 XRパケットをそのSSRCに関連付けられた「m =」セクションにコピーします. さらに、パケットの送信者SSRCが着信SSRCテーブルで見つかった場合は、XRパケットのコピーをそのSSRCに関連付けられた「m =」セクションに配信します. 

* RTCPパケットが[RFC4585]で定義されているようにタイプRTPFB（トランスポート層FBメッセージ）またはPSFB（ペイロード固有のFBメッセージ）のフィードバックメッセージである場合、メディアソースSSRCが含まれ、このSSRCは次の目的で使用されます. フィードバックメッセージの特定のサブタイプをルーティングします. ただし、PSFBおよびRTPFBメッセージのいくつかのサブタイプには、フィードバック制御情報（FCI）と呼ばれるセクションにターゲットSSRCが含まれています. これらのメッセージでは、ターゲットSSRCがルーティングに使用されます. 

* RTCPパケットがFCIセクションにターゲットSSRCを含まないフィードバックパケットであり、メディアソースSSRCが発信SSRCテーブルにある場合は、そのSSRCに関連付けられた「m =」セクションにフィードバックパケットを配信します. この方法で処理されるRTPFBおよびPSFBタイプには、次のものがあります. 

汎用NACK：（PT = RTPFB、FMT = 1）[RFC4585]. 

画像損失表示（PLI）：（ PT = PSFB、FMT = 1）[RFC4585]. 

スライス損失表示（SLI）：（ PT = PSFB、FMT = 2）[RFC4585]. 

参照画像選択表示（RPSI）：（ PT = PSFB、FMT = 3）[RFC4585]. 

* RTCPパケットがFCIセクションにターゲットSSRCを含むフィードバックメッセージである場合、それは要求または通知のいずれかです. 要求はメッセージ受信者によって送信されているRTPストリームを参照しますが、通知は以前の要求への応答であるため、メッセージ受信者によって受信されているRTPストリームを参照します. 

* RTCPパケットがターゲットSSRCを含むフィードバック要求である場合、送信SSRCテーブルで見つかったターゲットSSRCごとに、RTCPパケットのコピーをそのSSRCに関連付けられた「m =」セクションに配信します. この方法で処理されるPSFBおよびRTPFBタイプには、次のものがあります. 

フルイントラリクエスト（FIR）：（ PT = PSFB、FMT = 4）[RFC5104]. 

時間-空間トレードオフ要求（TSTR）：（ PT = PSFB、FMT = 5）[RFC5104]. 

H.271ビデオバックチャネルメッセージ（VBCM）：（ PT = PSFB、FMT = 7）[RFC5104]. 

一時的な最大メディアストリームビットレート要求（TMMBR）：（ PT = R TPFB、FMT = 3）[RFC5104]. 

レイヤー更新要求（LRR）：（ PT = PSFB、FMT = 10）[LLR-RTCP]. 

* RTCPパケットがターゲットSSRCを含むフィードバック通知である場合、着信SSRCテーブルで見つかったターゲットSSRCごとに、RTCPパケットのコピーをRTPストリームに関連付けられた「m =」セクションに配信します. 一致するSSRCを使用します. この方法で処理されるPSFBおよびRTPFBタイプには、次のものがあります. 

時間-空間トレードオフ通知（TSTN）：（ PT = PSFB、FMT = 6）[RFC5104]. このメッセージは、以前のTSTRへの応答です. 

一時的な最大メディアストリームビットレート通知（TMMBN）：（ PT = RTPFB、FMT = 4）[RFC5104]. このメッセージは、以前のTMMBRに応答する通知ですが、一方的に送信することもできます. 

RTCPパケットのタイプがAPPの場合、アプリケーション固有の方法で処理されます. アプリケーションがAPPパケットを認識しない場合は、破棄する必要があります. 

9.3. RTP / RTCP多重化
BUNDLEグループ内で、提供者と回答者は、RTPベースのバンドルメディアに対してRTP / RTCP多重化[RFC5761]を有効にする必要があります（つまり、RTPパケットとRTCPパケットの両方に同じトランスポートが使用されます）. さらに、提供者と回答者は、SDPの「rtcp-mux-only」属性をサポートする必要があります[RFC8858]. 

9.3.1. SDPオファー/回答手順
このセクションでは、提供者と回答者がSDP'rtcp-mux '[RFC5761]およびSDP'rtcp-mux-only'属性[RFC8858]を使用して、RTPベースのバンドルメディアのRTP / RTCP多重化の使用をネゴシエートする方法について説明します. 

RTP / RTCP多重化は、RTPベースのメディアにのみ適用されます. ただし、セクション7.1.3で説明されているように、オファーまたはアンサー内では、SDP'rtcp-mux 'およびSDP'rtcp-mux-only'属性が、非RTPベースのメディアのバンドルされた「m =」セクションに含まれる場合があります.  （そのような「m =」セクションが提供者タグ付きの「m =」セクションまたは回答者タグ付きの「m =」セクションである場合）. 

9.3.1.1. 最初のSDPバンドルオファーの生成
オファー提供者が最初のBUNDLEオファーを生成するとき、オファーにRTPベースのメディア用のバンドルされた「m =」セクションが1つ以上含まれている場合（または、RTPベースのメディア用の「m =」セクションが後で追加される可能性がある場合）バンドルグループへ）、提供者は、バンドルされた各「m =」セクション（バンドルのみの「m =」セクションを除く）にSDP'rtcp-mux '属性[RFC5761]を含める必要があります. さらに、提供者は、RTPベースのメディアの1つ以上のバンドルされた「m =」セクションにSDP「rtcp-mux-only」属性[RFC8858]を含めることができます（MAY）. 

注：提供者がSDPの「rtcp-mux-only」属性を含むかどうかは、回答者がRTPベースのメディアの1つ以上の「m =」セクションを移動した場合に、提供者がRTCPの別のポートの使用へのフォールバックをサポートするかどうかによって異なります. 答えのBUNDLEグループの. 

注：提供者がバンドルされた「m =」セクションにSDP「rtcp-mux」属性を含めているが、SDP「rtcp-mux-only」属性を含まない場合、提供者はSDP「rtcp」属性を含めることもできます[ [RFC5761]で説明されているように、RTCPのフォールバックポートを提供するために、1つ以上のRTPベースのバンドルされた「m =」セクションにRFC3605]. ただし、フォールバックポートは、応答者によってBUNDLEグループから移動されたRTPベースのメディアの「m =」セクションにのみ適用されます. 

最初のBUNDLEオファーでは、RTCPのアドレス：ポートの組み合わせは、RTPと同様に、RTPベースのメディア（バンドルのみの「m =」セクションを除く）のバンドルされた「m =」セクションごとに一意である必要があります. 

9.3.1.2. SDP回答の生成
回答者が回答を生成するとき、回答者がRTPベースのメディアをサポートし、対応するオファーのバンドルされた「m =」セクションにSDP「rtcp-mux」属性が含まれている場合、回答者はRTP / RTCP多重化の使用を有効にする必要があります. 現在、BUNDLEグループ内にRTPベースのメディア用のバンドルされた「m =」セクションがない場合でも. 回答者は、BUNDLE属性の手順（セクション7.1.3）に従って、回答者がタグ付けした「m =」セクションにSDP'rtcp-mux '属性を含める必要があります. さらに、提供者タグ付きの「m =」セクションとして選択された「m =」セクションにSDP「rtcp-mux-only」属性が含まれている場合、応答者はSDP「rtcp-mux-only」属性を含める必要があります. 回答者がタグ付けした「m =」セクション. 

最初のBUNDLEオファーで、提案されたオファータグ付きの「m =」セクションにSDPの「rtcp-mux-only」属性が含まれている場合、「m =」セクションはRTPベースのメディア用でした. したがって、回答者は作成されたBUNDLEグループの「m =」セクションを受け入れず、回答者は「m =」セクションをBUNDLEグループの外に移動する必要があります（セクション7.3.2）. 移動した「m =」セクションに属性を含め、「m =」セクションに関連付けられたメディアのRTP / RTCP多重化を有効にします. または、「m =」セクションを拒否します（セクション7.3.3）. 

回答者は、回答のバンドルされた「m =」セクションにSDP「rtcp」属性を含めてはなりません（MUSTNOT）. 回答者は、提供者がタグ付けした「m =」セクションのポート値を使用して、RTPベースのバンドルメディアに関連付けられたRTPおよびRTCPパケットを提供者に送信します. 

BUNDLEグループ内でのRTP / RTCP多重化の使用が以前のオファー/アンサー交換でネゴシエートされた場合、アンサーはアンサータグ付きの「m =」セクションにSDP「rtcp-mux」属性を含める必要があります. BUNDLEグループ内でRTP / RTCP多重化を無効にすることはできません. 

9.3.1.3. SDP回答の提供者処理
提供者が回答を受け取ったときに、回答者がRTP / RTCP多重化の使用を受け入れた場合（セクション9.3.1.2）、回答者は[RFC5761]で定義されているRTP / RTCP多重化の手順に従います. 提供者は、回答者がタグ付けした「m =」セクションのポート値を使用して、RTPベースのバンドルメディアに関連付けられたRTPおよびRTCPパケットを回答者に送信します. 

注：回答者がBUNDLEグループに含まれるRTPベースの「m =」セクションでのRTP / RTCP多重化の使用を受け入れなかった場合、プロトコルエラーと見なされます. 

9.3.1.4. セッションの変更
提供者が後続の提供を生成する場合、提供者は、セクション7.1.3のIDENTICAL多重化カテゴリ属性の手順に従って、提供者タグ付きの「m =」セクションにSDP'rtcp-mux '属性を含める必要があります. 

10.ICEに関する考慮事項
このセクションでは、BUNDLEグループ化拡張機能をICEメカニズム[RFC8445]と一緒に使用する方法について説明します. 

[RFC8839]で定義されているSDPを使用してICEの使用をネゴシエートするための一般的な手順は、次の例外を除いて、BUNDLEを使用したICEの使用にも適用されます. 

* BUNDLEトランスポートが確立されている場合、ICE接続チェックとキープアライブは、BUNDLEグループ内の個々のバンドルされた「m =」セクションごとではなく、BUNDLEトランスポートに対してのみ実行する必要があります. 

* 一般的なSDP属性のオファー/アンサーに関する考慮事項(セクション7.1.3)は、 ICE関連属性にも適用される。 したがって、オファー側が最初のBUNDLEオファーを送信するとき (BUNDLEグループをネゴシエートするため)、オファー側はICE関連のメディアレベル 属性を各バンドル「m=」セクションに含め、各「m=」セクションには固有のICEプロパティを含めなければならない(MUST)。 回答者がBUNDLEグループを含む回答（最初のBUNDLE回答またはそれ以降）を生成し、オファー側がBUNDLEグループを含む後続のオファーを送信する場合、ICE関連メディアレベル属性は、タグ付き「m=」セクション（オファー側タグ付き「m=」セクションまたは回答者タグ付き「m=」セクションの提案）にのみ含まれ、ICEプロパティはBUNDLEグループ内の各バンドル「m=」セクションに適用される。

注：ほとんどのICE関連のメディアレベルのSDP属性は、TRANSPORT多重化カテゴリ[RFC8859]に属しており、TRANSPORT多重化カテゴリの一般的なSDP属性の提供/回答の考慮事項が属性に適用されます. ただし、ICE関連の属性の場合、他の多重化カテゴリに属する​​ICE関連のメディアレベルの属性にも同じ考慮事項が適用されます. 

注：次のICE関連のメディアレベルのSDP属性が[RFC8839]で定義されています： 'candidate'、 'remote-candidates'、 'ice-mismatch'、 'ice-ufrag'、 'ice-pwd'、および 'ice -ペース '. 

最初に、ICEがメディアに使用される選択された候補ペアを生成する前に、複数のトランスポートが確立されている可能性があります（複数の候補ペアがテストされている場合）. ICEが候補ペアを選択すると、それらはBUNDLEトランスポートを形成します. 

ICEメカニズムとBUNDLE拡張機能のサポートと使用はオプションであり、このセクションの手順は、ICEメカニズムが使用されている場合にのみ適用されます. BUNDLE拡張機能が使用されていない場合でも、アプリケーションがICEメカニズムの使用を義務付ける場合があることに注意してください. 

注：Trickle ICEメカニズム[RFC8840]が使用されている場合、提供者と回答者は、ポート値「9」とIPv4アドレス「0.0.0.0」（またはIPv6に相当する「::」）を複数のバンドルに割り当てる場合があります. 最初のBUNDLEオファーの「m =」セクション. 提供者と回答者は、提案された提供者タグ付きの「m =」セクションとしてバンドルされた「m =」セクションを選択する、タグ付きの「m =」セクションを選択するなど、オファーと回答を生成するための通常の手順に従います. 違いは、1つ以上の候補者が提供されるまでメディアを送信できないことです. BUNDLEグループがネゴシエートされると、バンドルされた「m =」セクションに関連付けられた細流の候補者が、BUNDLEグループ内のすべてのバンドルされた「m =」セクションに適用されます. 

11.DTLSに関する考慮事項
BUNDLEグループ内の1つ以上のメディアストリームは、データを暗号化するため、または別の暗号化メカニズムを使用してメディアを暗号化する場合は暗号化キーをネゴシエートするために、Datagram Transport Layer Security（DTLS）プロトコル[RFC6347]を使用する場合があります. 

DTLSがBUNDLEグループ内で使用される場合、次のルールが適用されます. 

* BUNDLEグループに関連付けられるDTLSアソシエーション[RFC6347]は1つだけです. 

* BUNDLEグループ内のDTLSアソシエーションの各使用法は、どのエンドポイント（提供者または回答者）がDTLSクライアントおよびDTLSサーバーになるかを決定するために同じメカニズムを使用する必要があります. 

* BUNDLEグループ内のDTLSアソシエーションの各使用法は、オファーまたはアンサーが新しいDTLSアソシエーションの確立をトリガーするか、既存のDTLSアソシエーションが使用されるかを決定するために同じメカニズムを使用する必要があります. と

* DTLSクライアントがDTLS-SRTPをサポートしている場合、DTLSClientHelloメッセージ[RFC5764]に「use_srtp」拡張子を含める必要があります. DTLS-SRTPの使用がマルチメディアセッション（SIPセッション[RFC3261]など）の一部としてネゴシエートされていない場合でも、クライアントは拡張機能を含める必要があります. 

注：最初のDTLSハンドシェイク中に「use_srtp」拡張機能を含めると、後でマルチメディアセッション中にDTLS-SRTP暗号化メディアがBUNDLEグループに追加された場合に、拡張機能を含めるためにDTLS再ネゴシエーションが不要になります. 

12.RTPヘッダー拡張に関する考慮事項
この仕様のコンテキストでRTPヘッダー拡張機能[RFC8285]が使用される場合、特定の拡張機能に使用される識別子は、バンドルされているすべてのメディア記述で同じ拡張機能を識別しなければなりません. 

13. RFC3264への更新
このセクションでは、RFC 3264を更新して、メディアストリームの削除または無効化以外の目的で、拡張機能がオファーとアンサーのゼロポート値の使用を定義できるようにします. 次のセクションが更新されています. 

* "ユニキャストストリーム"; [RFC3264]のセクション5.1を参照してください

*「ユニキャストメディアストリームを保留にする」; [RFC3264]のセクション8.4を参照してください. 

13.1. RFC 3264、セクション5.1、第2段落からの元のテキスト
| recvonlyおよびsendrecvストリームの場合、|のポート番号とアドレス オファーは、オファー提供者がどこで受け取りたいかを示します. メディアストリーム. sendonly RTPストリームの場合、アドレスとポート| 番号は、提供者がRTCPを受信したい場所を間接的に示します. レポート. 特に明示的な指示がない限り、| レポートは、番号より1つ大きいポート番号に送信されます| 示されています. オファーに存在するIPアドレスとポートは|を示します RTPの送信元IPアドレスと送信元ポートについては何もありません. 提供者によって送信されるRTCPパケット. |のポート番号 オファーのゼロは、ストリームが提供されていることを示しますが、MUST | 使用しないでください. これには、最初のオファーでは有用なセマンティクスがありません. しかし、答えは次のことができるので、完全性の理由で許可されます. 拒否されたストリームを示すゼロポートが含まれています（セクション6）. | さらに、|を設定することにより、既存のストリームを終了できます. ゼロへのポート（セクション8）. 一般に、ポート番号はゼロです. メディアストリームが不要であることを示します. 

13.2. RFC 3264、セクション5.1、第2段落を置き換える新しいテキスト
recvonlyおよびsendrecvストリームの場合、オファーのポート番号とアドレスは、オファー側がメディアストリームを受信する場所を示します. sendonly RTPストリームの場合、アドレスとポート番号は、提供者がRTCPレポートを受信する場所を間接的に示します. 特に明記されていない限り、レポートは、示された番号より1つ大きいポート番号に送信されます. オファーに存在するIPアドレスとポートは、オファー側によって送信されるRTPおよびRTCPパケットの送信元IPアドレスと送信元ポートについて何も示していません. デフォルトでは、オファーのポート番号0は、ストリームが提供されているが使用してはならないことを示しますが、拡張メカニズムは、ゼロポート値の使用に対して異なるセマンティクスを指定する場合があります. さらに、ポートをゼロに設定することで、既存のストリームを終了できます（セクション8）. 

13.3. RFC 3264、セクション8.4、第6段落からの元のテキスト
| RFC 2543 [10]は、ユーザーを保留にすることは|であると指定しました. 接続アドレスを0.0.0.0に設定することで実現します. その| |通話を保留にするための使用は、推奨されなくなりました. 保持されたストリームでRTCPを使用することはできません. IPv6で動作し、コネクション型メディアで動作しません. | ただし、最初のオファーでは、オファー側が| 特定のメディアストリームのセットを使用したいことを知っている| フォーマットしますが、|の時点でアドレスとポートを知りません オファー. もちろん、使用する場合、ポート番号は|であってはなりません. ゼロ. これは、ストリームが無効になっていることを示します. | エージェントは、接続アドレスを使用してSDPを受信できる必要があります| 0.0.0.0の場合、RTPもRTCPも| ピアに送信する必要があります. 

13.4. RFC 3264、セクション8.4、第6段落を置き換える新しいテキスト
RFC 2543 [RFC2543]は、接続アドレスを0.0.0.0に設定することにより、ユーザーを保留にすることが達成されたことを指定しています. 保留中のストリームでRTCPを使用できず、IPv6で機能せず、コネクション型メディアで切断されるため、通話を保留にするための使用は推奨されなくなりました. ただし、最初のオファーでは、提供者が特定のメディアストリームとフォーマットのセットを使用することを知っているが、オファーの時点でアドレスとポートを知らない場合に役立ちます. もちろん、使用する場合、ストリームが無効になっていることを指定する場合は、ポート番号をゼロにしてはなりません. ただし、拡張メカニズムは、ゼロポート番号の使用法の異なるセマンティクスを指定する場合があります. エージェントは、接続アドレス0.0.0.0のSDPを受信できる必要があります. 

14. RFC5888に更新します
このセクションでは、RFC 5888 [RFC5888]を更新して、拡張機能が、ポートがゼロに設定された「m =」セクションを識別する識別タグを含むSDP「グループ」属性を許可できるようにします. 「回答のグループ値」（[RFC5888]のセクション9.2）が更新されました. 

14.1. RFC 5888、セクション9.2、第3段落からの元のテキスト
| SIPエンティティは、|でポートをゼロに設定することにより、メディアストリームを拒否します. 対応する「m」行. 「a = group」行には|を含めることはできません ポートが設定された「m」行に対応する識別タグ| ゼロに. 

14.2. RFC 5888、セクション9.2、第3段落を置き換える新しいテキスト
SIPエンティティは、対応する「m」行でポートをゼロに設定することにより、メディアストリームを拒否します. 「a = group」行には、ポートがゼロに設定された「m」行に対応する識別タグを含めてはなりませんが、拡張メカニズムは、そのような「m =」行に対応する識別タグを含めるための異なるセマンティクスを指定する場合があります. 

15.識別タグトランスポート用のRTP / RTCP拡張
提供者と回答者[RFC3264]は、[RFC5888]の手順を使用して、識別タグを提案と回答内の「m =」セクションに関連付けることができます. 各識別タグは、「m =」セクションを一意に表します. 

このセクションでは、新しいRTCP SDESアイテム[RFC3550]、「MID」を定義します. これは、RTCPSDESパケット内で識別タグを伝送するために使用されます. このセクションでは、新しいRTPSDESヘッダー拡張[RFC7941]も定義します. これは、RTPパケットで「MID」RTCPSDESアイテムを伝送するために使用されます. 

SDESアイテムとRTPSDESヘッダー拡張により、受信者は各RTPストリームを特定の「m =」セクションに関連付けることができます. これらの「m =」セクションが一部である場合でも、受信者はこのセクションに識別タグを関連付けます. 同じRTPセッション. RTP SDESヘッダー拡張機能は、メディア受信者が最初のデコード可能なメディアの受信時にIDタグを取得し、メディアを正しいアプリケーションに関連付けることができるようにします. 

メディア受信者は、「id」属性を使用して「m =」セクションに関連付けられた識別タグについてメディア送信者に通知します[RFC5888]. 次に、メディア送信者は、メディア受信者に送信されるRTCPおよびRTPパケットに識別タグを挿入します. 

注：上記のテキストは、オファーとアンサーで識別タグがどのように運ばれるかを定義しています. 識別タグを運ぶための他のシグナリングプロトコルの使用は妨げられませんが、そのようなプロトコルの使用はこのドキュメントの範囲外です. 

[RFC3550]は、RTCP送信間隔に関する一般的な手順を定義しています. RTCP MID SDESアイテムは、セッションに参加した後、最初の数個のRTCPパケットで送信する必要があり、その後は定期的に送信する必要があります. このSDESアイテムが送信されるRTCPパケットの正確な数は、予想されるパケット損失率、RTCPレポート間隔、および許容されるオーバーヘッドに依存するため、ここでは意図的に指定されていません. 

'MID' RTCPSDESを伝送するためのRTPSDESヘッダー拡張は、セッションの開始時およびSSRCが変更されるたびに一部のRTPパケットに含まれる必要があります. メディア内のアクセスポイントを構成するRTPパケットにヘッダー拡張を含めることも役立つ場合があります（たとえば、ビデオIフレームを使用）. このヘッダー拡張が送信されるRTPパケットの正確な数は、予想されるパケット損失率と損失パターン、アプリケーションが許容できるオーバーヘッド、およびIDの即時受信の重要性に依存するため、ここでは意図的に指定していません. 鬼ごっこ. 

堅牢性を確保するために、エンドポイントは、識別タグの受信が遅れる状況に備えて準備する必要があります. そのような場合、識別タグがすぐに到着する可能性があるため、セッションを終了しないでください. 

15.1. RTCP MIDSDESアイテム
       0 1 2 3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- +-+-+-+-+-+-+-+
      | MID = 15 | 長さ| 識別タグ... 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- +-+-+-+-+-+-+-+
        
識別タグのペイロードは、SDPと同様に、UTF-8でエンコードされています[RFC3629]. 

識別タグはゼロで終了していません. 

15.2. MIDのRTPSDESヘッダー拡張
識別タグを含むRTPSDESヘッダー拡張要素のペイロードは、1バイトまたは2バイトのヘッダー[RFC7941]のいずれかを使用してエンコードできます. 識別タグのペイロードは、SDPと同様にUTF-8でエンコードされます. 

識別タグはゼロで終了していません. パケットに含まれるヘッダー拡張のセットは、ゼロバイトを使用して次の32ビット境界にパディングする必要があることに注意してください[RFC8285]. 

識別タグはRTCPSDESアイテム、RTP SDESヘッダー拡張、またはその両方に含まれているため、識別タグによって引き起こされるパケット拡張について考慮する必要があります. RTPパケットのMaximumTransmission Unit（MTU）の問題を回避するには、メディアをエンコードするときにヘッダー拡張のサイズを考慮する必要があります. 

識別タグは短くすることをお勧めします. RTPヘッダー拡張メカニズムの特性により、1バイトのヘッダーを使用する場合、1〜3バイトのタグは、他にない場合に備えて、RTPSDESヘッダー拡張に使用される32ビットワードの数を最小限に抑えます. ヘッダー拡張も同時に含まれています. UTF-8でエンコードされた場合、一部の単一文字が複数のオクテットになることに注意してください. 識別タグにはユーザー情報を含めてはなりません. アプリケーションは、ユーザーまたはアプリケーションの識別を可能にするパターンを使用して識別タグを生成しないようにする必要があります. 

16.IANAの考慮事項
16.1. 新しいSDESアイテム
このドキュメントでは、MIDSDESアイテムをIANAの「RTPSDESアイテムタイプ」レジストリに次のように追加します. 

値：15

略語：MID

名前：メディアID

参照：RFC 8843

16.2. 新しいRTPSDESヘッダー拡張URI
このドキュメントでは、次のデータに従って、RTP Compact HeaderExtensionsレジストリサブレジストリのRTPSDES Compact HeaderExtensionsサブレジストリに新しい拡張URIを定義します. 

      拡張URI：urn：ietf：params：rtp-hdrext：sdes：mid
        
説明：メディアの識別

      連絡先：IESG（iesg@ietf.org）
        
参照：RFC 8843

SDESアイテムは、ユーザーに関するプライバシー情報を明らかにしません. これは、RTPベースのメディアをメディアのネゴシエーションに使用されるSDPの正しいSDPメディア記述（ "m ="セクション）に関連付けるために使用されます. 

拡張の目的は、提供者が関連する回答を受信する前に、受信した多重化RTPベースのメディアを提供者が関連付けることができるようにすることです. 

16.3. 新しいSDP属性
このドキュメントでは、次のデータに従って、新しいSDPメディアレベル属性「バンドルのみ」を定義しています. 

属性名：バンドルのみ

属性のタイプ：メディア

文字セットの対象：いいえ

目的：回答者がBUNDLEグループ内に保持している場合にのみ、回答で受け入れられるようにメディアの説明を要求します. 

適切な値：N / A

連絡先名：IESG

連絡先の電子メール：iesg@ietf.org

参照：RFC 8843

Muxカテゴリ：NORMAL

16.4. 新しいSDPグループのセマンティクス
このドキュメントは、「「グループ」SDP属性のセマンティクス」サブレジストリ（「セッション記述プロトコル（SDP）パラメータ」レジストリの下）のIANAに次のセマンティクスを登録します. 

   + ================ + ======== + ============== + ======== === +
   | セマンティクス| トークン| Muxカテゴリ| リファレンス|
   + ================ + ======== + ============== + ======== === +
   | メディアのバンドル| バンドル| ノーマル| RFC 8843 |
   + ---------------- + -------- + -------------- + -------- --- +
        
表1

17.セキュリティに関する考慮事項
[RFC3264]および[RFC5888]で定義されているセキュリティ上の考慮事項は、BUNDLE拡張機能に適用されます. BUNDLEは、以下で説明するMID SDESアイテムの使用を除いて、RTPストリームなどのどの情報がネットワーク上を流れるかを変更しません. 主に、どのアドレスとポート、つまりどの（RTP）セッションで、情報が流れるかを変更します. これは、使用されているセキュリティコンテキストに影響し、以前に分離された情報フローが同じセキュリティコンテキストを共有する原因となる可能性があります. これは、RTPセッションのセキュリティメカニズムのパフォーマンスにほとんど影響を与えません. バンドルされているさまざまなRTPストリームにさまざまなセキュリティポリシーを適用した場合、またはセキュリティコンテキストにアクセスできる当事者がRTPストリーム間で異なっていた場合は、

トランスポート、RTCP SDESパケット、またはRTPヘッダー拡張に依存しない識別タグは、シグナリングチェーンを超えてパーティに値を公開できます. したがって、識別タグの値は、ユーザー情報を漏らさない方法で生成する必要があります. たとえば、ランダムに、またはバンドルごとのグループカウンターを使用して生成する必要があります. また、MID RTPヘッダーに効率的に収まるように、3バイト以下にする必要があります. 拡大. 実装が識別タグを生成するために異なる方法を使用する場合、これにより実装のフィンガープリントが有効になり、標的型攻撃に対して脆弱になる可能性があることに注意してください. 識別タグは、RTPヘッダー拡張に含まれている場合、RTPストリームレベルで公開されます. でも、エンドポイントとアプリケーションのRTPメディアストリーム構造について明らかにしたことは、MIDSDESヘッダー拡張なしでRTPストリームから推測することがすでに可能でした. 識別タグは、メディアストリームを適切なアプリケーション機能にルーティングするためにも使用されるため、受信した値が送信者が意図したものであることが重要です. したがって、ソースの整合性と信頼性は、アプリケーションでのサービス拒否を防ぐために重要です. RTP / RTCPパケット全体を保護する既存のSRTP構成およびその他のセキュリティメカニズムは、必要な保護を提供します. アプリケーションでのサービス拒否を防ぐには、ソースの整合性と信頼性が重要です. RTP / RTCPパケット全体を保護する既存のSRTP構成およびその他のセキュリティメカニズムは、必要な保護を提供します. アプリケーションでのサービス拒否を防ぐには、ソースの整合性と信頼性が重要です. RTP / RTCPパケット全体を保護する既存のSRTP構成およびその他のセキュリティメカニズムは、必要な保護を提供します. 

BUNDLE拡張機能を使用する場合、バンドルされているすべてのメディア記述で使用されるセキュリティメカニズムの一連の構成は、少なくとも方向またはエンドポイントごとに同時に使用できるように、互換性がある必要があります. SRTPを使用する場合、これは、少なくともIETFで定義されたキー管理ソリューションの場合に当てはまります. これは、SDP属性（ "a = crypto"、 "a = fingerprint"、 "a = mikey"）と[ RFC8859]. 

「RTP制御プロトコル（RTCP）ソース記述項目のRTPヘッダー拡張」[RFC7941]のセキュリティ上の考慮事項では、RTCPが機密保護されている場合、MIDRTPヘッダー拡張などのSDES項目を保持するSDERSTPヘッダー拡張は次のようになります. また、相応の強度アルゴリズムを使用して保護されています. ただし、上記の要件と推奨事項が守られていると仮定すると、機密保護なしでMIDRTPヘッダー拡張を残すことによる既知の重大なセキュリティリスクはありません. したがって、この仕様は、MIDRTPヘッダー拡張に対してこの要件が無視される可能性があるという例外を追加することによってRFC7941を更新します. RTP / RTCPのセキュリティメカニズムについては、「RTPセッションを保護するためのオプション」[RFC7201]などで説明されています. 

18.例
18.1. 例：タグ付きの「m =」セクションの選択
以下の例は次のとおりです. 

*最初のBUNDLEオファー. オファー提供者は、BUNDLEグループのネゴシエーションを希望し、オーディオの「m =」セクションを提案されたオファー提供者タグ付きの「m =」セクションとして示します. 

*最初のBUNDLE回答では、回答者がBUNDLEグループの作成を受け入れ、オファー内の音声「m =」セクションを提供者タグ付きの「m =」セクションとして選択し、音声「m =」セクションを選択します. 回答者がタグ付けした「m =」セクションとして回答し、回答者のBUNDLE address：portをその「m =」セクションに割り当てます. 

SDPオファー（1）

       v = 0
       o = alice 2890844526 2890844526 IN IP6 2001：db8 :: 3
       s =
       c = IN IP6 2001：db8 :: 3
       t = 0 0
       a = group：BUNDLE foo bar
        
       m = audio 10000 RTP / AVP 0 8 97
       b = AS：200
       a = mid：foo
       a = rtcp-mux
       a = rtpmap：0 PCMU / 8000
       a = rtpmap：8 PCMA / 8000
       a = rtpmap：97 iLBC / 8000
       a = extmap：1 urn：ietf：params：rtp-hdrext：sdes：mid
        
       m =ビデオ10002RTP / AVP 31 32
       b = AS：1000
       a = mid：bar
       a = rtcp-mux
       a = rtpmap：31 H261 / 90000
       a = rtpmap：32 MPV / 90000
       a = extmap：1 urn：ietf：params：rtp-hdrext：sdes：mid
        
SDP回答（2）

       v = 0
       o = bob 2808844564 2808844564 IN IP6 2001：db8 :: 1
       s =
       c = IN IP6 2001：db8 :: 1
       t = 0 0
       a = group：BUNDLE foo bar
        
       m = audio 20000 RTP / AVP 0
       b = AS：200
       a = mid：foo
       a = rtcp-mux
       a = rtpmap：0 PCMU / 8000
       a = extmap：1 urn：ietf：params：rtp-hdrext：sdes：mid
        
       m =ビデオ0RTP / AVP 32
       b = AS：1000
       a = mid：bar
       a =バンドルのみ
       a = rtpmap：32 MPV / 90000
       a = extmap：1 urn：ietf：params：rtp-hdrext：sdes：mid
        
18.2. 例：BUNDLEグループが拒否されました
以下の例は次のとおりです. 

*最初のBUNDLEオファー. オファー提供者は、BUNDLEグループのネゴシエーションを希望し、オーディオの「m =」セクションを提案されたオファー提供者タグ付きの「m =」セクションとして示します. 

*最初のBUNDLE回答. 回答者は、BUNDLEグループの作成を拒否し、通常の回答を生成し、回答の各「m =」セクションに一意のaddress：portを割り当てます. 

SDPオファー（1）

       v = 0
       o = alice 2890844526 2890844526 IN IP6 2001：db8 :: 3
       s =
       c = IN IP6 2001：db8 :: 3
       t = 0 0
       a = group：BUNDLE foo bar
        
       m = audio 10000 RTP / AVP 0 8 97
       b = AS：200
       a = mid：foo
       a = rtcp-mux
       a = rtpmap：0 PCMU / 8000
       a = rtpmap：8 PCMA / 8000
       a = rtpmap：97 iLBC / 8000
       a = extmap：1 urn：ietf：params：rtp-hdrext：sdes：mid
        
       m =ビデオ10002RTP / AVP 31 32
       b = AS：1000
       a = mid：bar
       a = rtcp-mux
       a = rtpmap：31 H261 / 90000
       a = rtpmap：32 MPV / 90000
       a = extmap：1 urn：ietf：params：rtp-hdrext：sdes：mid
        
SDP回答（2）

       v = 0
       o = bob 2808844564 2808844564 IN IP6 2001：db8 :: 1
       s =
       c = IN IP6 2001：db8 :: 1
       t = 0 0
        
       m = audio 20000 RTP / AVP 0
       b = AS：200
       a = rtcp-mux
       a = rtpmap：0 PCMU / 8000
        
       m =ビデオ30000RTP / AVP 32
       b = AS：1000
       a = rtcp-mux
       a = rtpmap：32 MPV / 90000
        
18.3. 例：提供者がBUNDLEグループにメディアの説明を追加する
以下の例は次のとおりです. 

*後続のオファー. オファー提供者は、以前にネゴシエートされたBUNDLEグループに、「zen」識別タグで示される新しいバンドルされた「m =」セクション（ビデオ）を追加します. 新しい「m =」セクションを提供者タグ付きの「m =」セクションとして示します. そして、提供者のBUNDLE address：portをその「m =」セクションに割り当てます. 

*後続の回答. 回答者は回答の新しい動画「m =」セクションを回答者タグ付きの「m =」セクションとして示し、回答者のBUNDLE address：portをその「m =」セクションに割り当てます. 

SDPオファー（1）

       v = 0
       o = alice 2890844526 2890844526 IN IP6 2001：db8 :: 3
       s =
       c = IN IP6 2001：db8 :: 3
       t = 0 0
       a = group：BUNDLE zen foo bar
        
       m = audio 0 RTP / AVP 0 8 97
       b = AS：200
       a = mid：foo
       a =バンドルのみ
       a = rtpmap：0 PCMU / 8000
       a = rtpmap：8 PCMA / 8000
       a = rtpmap：97 iLBC / 8000
       a = extmap：1 urn：ietf：params：rtp-hdrext：sdes：mid
        
       m =ビデオ0RTP / AVP 31 32
       b = AS：1000
       a = mid：bar
       a =バンドルのみ
       a = rtpmap：31 H261 / 90000
       a = rtpmap：32 MPV / 90000
       a = extmap：1 urn：ietf：params：rtp-hdrext：sdes：mid
        
       m =ビデオ10000RTP / AVP 66
       b = AS：1000
       a = mid：zen
       a = rtcp-mux
       a = rtpmap：66 H261 / 90000
       a = extmap：1 urn：ietf：params：rtp-hdrext：sdes：mid
        
SDP回答（2）

       v = 0
       o = bob 2808844564 2808844564 IN IP6 2001：db8 :: 1
       s =
       c = IN IP6 2001：db8 :: 1
       t = 0 0
       a = group：BUNDLE zen foo bar
        
       m = audio 0 RTP / AVP 0
       b = AS：200
       a = mid：foo
       a =バンドルのみ
       a = rtpmap：0 PCMU / 8000
       a = extmap：1 urn：ietf：params：rtp-hdrext：sdes：mid
        
       m =ビデオ0RTP / AVP 32
       b = AS：1000
       a = mid：bar
       a =バンドルのみ
       a = rtpmap：32 MPV / 90000
       a = extmap：1 urn：ietf：params：rtp-hdrext：sdes：mid
        
       m =ビデオ20000RTP / AVP 66
       b = AS：1000
       a = mid：zen
       a = rtcp-mux
       a = rtpmap：66 H261 / 90000
       a = extmap：1 urn：ietf：params：rtp-hdrext：sdes：mid
        
18.4. 例：提供者がメディアの説明をバンドルグループから移動する
以下の例は次のとおりです. 

*オファー提供者が、以前にネゴシエートされたBUNDLEグループから「zen」識別タグで示される「m =」セクション（ビデオ）を削除する後続のオファー. 提供者タグ付きの「m =」セクションとしてBUNDLEグループに残っているバンドルされた「m =」セクション（オーディオ）の1つを示します. そして、提供者のBUNDLE address：portをその「m =」セクションに割り当てます. 

*回答者がBUNDLEグループから「m =」セクションを削除する後続の回答は、回答の音声「m =」セクションを回答者タグ付きの「m =」セクションとして示し、回答者にBUNDLEアドレスを割り当てます. その「m =」セクションに移植します. 

SDPオファー（1）

       v = 0
       o = alice 2890844526 2890844526 IN IP6 2001：db8 :: 3
       s =
       c = IN IP6 2001：db8 :: 3
       t = 0 0
       a = group：BUNDLE foo bar
        
       m = audio 10000 RTP / AVP 0 8 97
       b = AS：200
       a = mid：foo
       a = rtcp-mux
       a = rtpmap：0 PCMU / 8000
       a = rtpmap：8 PCMA / 8000
       a = rtpmap：97 iLBC / 8000
       a = extmap：1 urn：ietf：params：rtp-hdrext：sdes：mid
        
       m =ビデオ0RTP / AVP 31 32
       b = AS：1000
       a = mid：bar
       a =バンドルのみ
       a = rtpmap：31 H261 / 90000
       a = rtpmap：32 MPV / 90000
       a = extmap：1 urn：ietf：params：rtp-hdrext：sdes：mid
        
       m =ビデオ50000RTP / AVP 66
       b = AS：1000
       a = mid：zen
       a = rtcp-mux
       a = rtpmap：66 H261 / 90000
        
SDP回答（2）

       v = 0
       o = bob 2808844564 2808844564 IN IP6 2001：db8 :: 1
       s =
       c = IN IP6 2001：db8 :: 1
       t = 0 0
       a = group：BUNDLE foo bar
        
       m = audio 20000 RTP / AVP 0
       b = AS：200
       a = mid：foo
       a = rtcp-mux
       a = rtpmap：0 PCMU / 8000
       a = extmap：1 urn：ietf：params：rtp-hdrext：sdes：mid
        
       m =ビデオ0RTP / AVP 32
       b = AS：1000
       a = mid：bar
       a =バンドルのみ
       a = rtpmap：32 MPV / 90000
       a = extmap：1 urn：ietf：params：rtp-hdrext：sdes：mid
        
       m =ビデオ60000RTP / AVP 66
       b = AS：1000
       a = mid：zen
       a = rtcp-mux
       a = rtpmap：66 H261 / 90000
        
18.5. 例：提供者がBUNDLEグループ内のメディア記述を無効にする

以下の例は次のとおりです. 

*後続のオファー. オファー側は、以前にネゴシエートされたBUNDLEグループからの「zen」識別タグで示される「m =」セクション（ビデオ）を（ゼロポート値を割り当てることによって）無効にします. バンドルされた「m =」セクション（オーディオ）の1つが、提供者タグ付きの「m =」セクションとしてBUNDLEグループでアクティブなままであることを示します. そして、提供者のBUNDLE address：portをその「m =」セクションに割り当てます. 

*回答者が「m =」セクションを無効にする後続の回答は、回答の音声「m =」セクションを回答者タグ付きの「m =」セクションとして示し、回答者のBUNDLE address：portをそれに割り当てます.  m = "セクション. 

SDPオファー（1）

       v = 0
       o = alice 2890844526 2890844526 IN IP6 2001：db8 :: 3
       s =
       t = 0 0
       a = group：BUNDLE foo bar
        
       m = audio 10000 RTP / AVP 0 8 97
       c = IN IP6 2001：db8 :: 3
       b = AS：200
       a = mid：foo
       a = rtcp-mux
       a = rtpmap：0 PCMU / 8000
       a = rtpmap：8 PCMA / 8000
       a = rtpmap：97 iLBC / 8000
       a = extmap：1 urn：ietf：params：rtp-hdrext：sdes：mid
        
       m =ビデオ0RTP / AVP 31 32
       c = IN IP6 2001：db8 :: 3
       b = AS：1000
       a = mid：bar
       a =バンドルのみ
       a = rtpmap：31 H261 / 90000
       a = rtpmap：32 MPV / 90000
       a = extmap：1 urn：ietf：params：rtp-hdrext：sdes：mid
        
       m =ビデオ0RTP / AVP 66
       a = mid：zen
       a = rtpmap：66 H261 / 90000
        
SDP回答（2）

       v = 0
       o = bob 2808844564 2808844564 IN IP6 2001：db8 :: 1
       s =
       t = 0 0
       a = group：BUNDLE foo bar
        
       m = audio 20000 RTP / AVP 0
       c = IN IP6 2001：db8 :: 1
       b = AS：200
       a = mid：foo
       a = rtcp-mux
       a = rtpmap：0 PCMU / 8000
       a = extmap：1 urn：ietf：params：rtp-hdrext：sdes：mid
        
       m =ビデオ0RTP / AVP 32
       c = IN IP6 2001：db8 :: 1
       b = AS：1000
       a = mid：bar
       a =バンドルのみ
       a = rtpmap：32 MPV / 90000
       a = extmap：1 urn：ietf：params：rtp-hdrext：sdes：mid
        
       m =ビデオ0RTP / AVP 66
       a = mid：zen
       a = rtpmap：66 H261 / 90000
        
19.参考文献
19.1. 規範的参照
[RFC2119] Bradner、S. 、「要件レベルを示すためにRFCで使用するキーワード」、BCP 14、RFC 2119、DOI 10.17487 / RFC2119、1997年3月、<https://www.rfc-editor.org/info/ rfc2119>. 

[RFC3264] Rosenberg、J. およびH. Schulzrinne、「Session Description Protocol（SDP）を使用したオファー/アンサーモデル」、RFC 3264、DOI 10.17487 / RFC3264、2002年6月、<https://www.rfc-editor.org / info / rfc3264>. 

[RFC3550] Schulzrinne、H.、Casner、S.、Frederick、R. 、およびV. Jacobson、「RTP：A Transport Protocol for Real-Time Applications」、STD 64、RFC 3550、DOI 10.17487 / RFC3550、2003年7月、 <https://www.rfc-editor.org/info/rfc3550>. 

[RFC3605] Huitema、C. 、「Session Description Protocol（SDP）のReal Time Control Protocol（RTCP）属性」、RFC 3605、DOI 10.17487 / RFC3605、2003年10月、<https://www.rfc-editor.org/ info / rfc3605>. 

[RFC3629] Yergeau、F. 、「UTF-8、ISO 10646の変換形式」、STD 63、RFC 3629、DOI 10.17487 / RFC3629、2003年11月、<https://www.rfc-editor.org/info/ rfc3629>. 

[RFC3711] Baugher、M.、McGrew、D.、Naslund、M.、Carrara、E. 、およびK. Norrman、「The Secure Real-time Transport Protocol（SRTP）」、RFC 3711、DOI 10.17487 / RFC3711、3月2004年、<https://www.rfc-editor.org/info/rfc3711>. 

[RFC4566] Handley、M.、Jacobson、V. 、およびC. Perkins、「SDP：Session Description Protocol」、RFC 4566、DOI 10.17487 / RFC4566、2006年7月、<https://www.rfc-editor.org/ info / rfc4566>. 

[RFC4961] Wing、D. 、「Symmetric RTP / RTP Control Protocol（RTCP）」、BCP 131、RFC 4961、DOI 10.17487 / RFC4961、2007年7月、<https://www.rfc-editor.org/info/rfc4961 >. 

[RFC5761] Perkins、C. およびM. Westerlund、「単一ポートでのRTPデータと制御パケットの多重化」、RFC 5761、DOI 10.17487 / RFC5761、2010年4月、<https://www.rfc-editor.org/info / rfc5761>. 

[RFC5764] McGrew、D. およびE. Rescorla、「Secure Real-time Transport Protocol（SRTP）のキーを確立するためのDatagram Transport Layer Security（DTLS）拡張」、RFC 5764、DOI 10.17487 / RFC5764、2010年5月、<https ：//www.rfc-editor.org/info/rfc5764>. 

[RFC5888] Camarillo、G. およびH. Schulzrinne、「The Session Description Protocol（SDP）Grouping Framework」、RFC 5888、DOI 10.17487 / RFC5888、2010年6月、<https://www.rfc-editor.org/info/ rfc5888>. 

[RFC6347] Rescorla、E. およびN. Modadugu、「Datagram Transport Layer Security Version 1.2」、RFC 6347、DOI 10.17487 / RFC6347、2012年1月、<https://www.rfc-editor.org/info/rfc6347>. 

[RFC7941] Westerlund、M.、Burman、B.、Even、R. 、およびM. Zanaty、「RTP制御プロトコル（RTCP）ソース記述項目のRTPヘッダー拡張」、RFC 7941、DOI 10.17487 / RFC7941、2016年8月、<https://www.rfc-editor.org/info/rfc7941>. 

[RFC8174] Leiba、B. 、「RFC 2119キーワードにおける大文字と小文字のあいまいさ」、BCP 14、RFC 8174、DOI 10.17487 / RFC8174、2017年5月、<https://www.rfc-editor.org/info/ rfc8174>. 

[RFC8285] Singer、D.、Desineni、H.、and R. Even、Ed. 、 "A General Mechanism for RTP Header Extensions"、RFC 8285、DOI 10.17487 / RFC8285、October 2017、<https：//www.rfc -editor.org/info/rfc8285>. 

[RFC8445] Keranen、A.、Holmberg、C. 、およびJ. Rosenberg、「Interactive Connectivity Establishment（ICE）：A Protocol for Network Address Translator（NAT）Traversal」、RFC 8445、DOI 10.17487 / RFC8445、2018年7月、< https://www.rfc-editor.org/info/rfc8445>. 

[RFC8839] Petit-Huguenin、M.、Nandakumar、S.、Holmberg、C.、Keränen、A. 、およびR. Shpount、「Interactive Connectivity Establishment（ICE）のSession Description Protocol（SDP）Offer / Answer Procedures」、 RFC 8839、DOI 10.17487 / RFC8839、2021年1月、<https://www.rfc-editor.org/info/rfc8839>. 

[RFC8840] Ivov、E.、Stach、T.、Marocco、E. 、およびC. Holmberg、「Interactive Connectivity Establishment（Trickle ICE）の候補者のインクリメンタルプロビジョニングのためのセッション開始プロトコル（SIP）の使用法」、RFC 8840 、DOI 10.17487 / RFC8840、2021年1月、<https://www.rfc-editor.org/info/rfc8840>. 

[RFC8858] Holmberg、C. 、 "Indicating Exclusive Support of RTP and RTP Control Protocol（RTCP）Multiplexing Using the Session Description Protocol（SDP）"、RFC 8858、DOI 10.17487 / RFC8858、January 2021、<https：// www.  rfc-editor.org/info/rfc8858>. 

[RFC8859] Nandakumar、S. 、「多重化時のセッション記述プロトコル（SDP）属性のフレームワーク」、RFC 8859、DOI 10.17487 / RFC8859、2021年1月、<https://www.rfc-editor.org/info/rfc8859 >. 

19.2. 有益な参考資料
[LLR-RTCP] Lennox、J.、Hong、D.、Uberti、J.、Holmer、S. 、およびM. Flodman、「The Layer Refresh Request（LRR）RTCP Feedback Message」、作業中、インターネットドラフト、draft-ietf-avtext-lrr-07、2017年7月2日、<https://tools.ietf.org/html/draft-ietf-avtext-lrr-07>. 

[RFC2543] Handley、M.、Schulzrinne、H.、Schooler、E. 、およびJ. Rosenberg、「SIP：Session Initiation Protocol」、RFC 2543、DOI 10.17487 / RFC2543、1999年3月、<https：//www.rfc -editor.org/info/rfc2543>. 

[RFC3261] Rosenberg、J.、Schulzrinne、H.、Camarillo、G.、Johnston、A.、Peterson、J.、Sparks、R.、Handley、M. 、およびE. Schooler、「SIP：SessionInitiationProtocol」 、RFC 3261、DOI 10.17487 / RFC3261、2002年6月、<https://www.rfc-editor.org/info/rfc3261>. 

[RFC3611] Friedman、T.、Ed. 、Caceres、R.、Ed. 、and A. Clark、Ed. 、 "RTP Control Protocol Extended Reports（RTCP XR）"、RFC 3611、DOI 10.17487 / RFC3611、2003年11月、 <https://www.rfc-editor.org/info/rfc3611>. 

[RFC4585] Ott、J.、Wenger、S.、Sato、N.、Burmeister、C.、and J. Rey、 "Extended RTP Profile for Real-time Transport Control Protocol（RTCP）-Based Feedback（RTP / AVPF） "、RFC 4585、DOI 10.17487 / RFC4585、2006年7月、<https://www.rfc-editor.org/info/rfc4585>. 

[RFC5104] Wenger、S.、Chandra、U.、Westerlund、M. 、およびB. Burman、「フィードバック付きRTPオーディオビジュアルプロファイル（AVPF）のコーデック制御メッセージ」、RFC 5104、DOI 10.17487 / RFC5104、2月2008、<https://www.rfc-editor.org/info/rfc5104>. 

[RFC5576] Lennox、J.、Ott、J. 、およびT. Schierl、「Session Description Protocol（SDP）のソース固有のメディア属性」、RFC 5576、DOI 10.17487 / RFC5576、2009年6月、<https：// www.rfc-editor.org/info/rfc5576>. 

[RFC7160] Petit-Huguenin、M. and G. Zorn、Ed. 、 "Support for Multiple Clock Rate in a RTP Session"、RFC 7160、DOI 10.17487 / RFC7160、April 2014、<https：//www.rfc-editor .org / info / rfc7160>. 

[RFC7201] Westerlund、M. and C. Perkins、 "Options for Securing RTP Sessions"、RFC 7201、DOI 10.17487 / RFC7201、April 2014、<https://www.rfc-editor.org/info/rfc7201>. 

[RFC7656] Lennox、J.、Gross、K.、Nandakumar、S.、Salgueiro、G.、and B. Burman、Ed. 、 "A Taxonomy of Semantics and Mechanisms for Real-Time Transport Protocol（RTP）Sources"、 RFC 7656、DOI 10.17487 / RFC7656、2015年11月、<https://www.rfc-editor.org/info/rfc7656>. 

[RFC7657] Black、D.、Ed. およびP.ジョーンズ、「Differentiated Services（Diffserv）and Real-Time Communication」、RFC 7657、DOI 10.17487 / RFC7657、2015年11月、<https://www.rfc-editor.org/info/rfc7657>. 

[RFC8829] Uberti、J.、Jennings、C.、and E. Rescorla、Ed. 、 "JavaScript Session Establishment Protocol（JSEP）"、RFC 8829、DOI 10.17487 / RFC8829、January 2021、<https：//www.rfc -editor.org/info/rfc8829>. 

[RFC8838] Ivov、E.、Uberti、J. 、およびP. Saint-Andre、「Trickle ICE：Interactive Connectivity Establishment（ICE）Protocolの候補のインクリメンタルプロビジョニング」、RFC 8838、DOI 10.17487 / RFC8838、2021年1月<https://www.rfc-editor.org/info/rfc8838>. 

付録A.設計上の考慮事項
BUNDLEグループ化拡張機能に関する主な問題の1つは、拡張機能の目的が「m =」セクションで指定されたメディアの単一のトランスポート. 付録で説明されている両方のアプローチの問題が提起されています. その結果、異なるポート値と同一のポート値の両方を持つオファーを使用するメカニズムを指定することになりました. 

以下は、「BUNDLE」グループ化拡張機能を定義するときに考慮された主な問題です. 

1）既存のユーザーエージェント（UA）との相互運用性. 

2）中間のBack-to-Back User Agent（B2BUA）およびプロキシエンティティとの相互運用性. 

3）ICE候補者を集める時間と数. 

4）さまざまなエラーシナリオとそれらが発生するタイミング. 

5）ポート番号値ゼロの使用を含むSDPオファー/アンサーの影響. 

A.1. UAの相互運用性
アリスがボブにオファーを送信する、次のSDPオファー/アンサー交換について考えてみます. 

SDPオファー

v = 0 o = alice 2890844526 2890844526 IN IP4 atlanta.example.com s = c = IN IP4 atlanta.example.com t = 0 0

       m = audio 10000 RTP / AVP 97
       a = rtpmap：97 iLBC / 8000
       m =ビデオ10002RTP / AVP 97
       a = rtpmap：97 H261 / 90000
        
SDP回答

v = 0 o = bob 2808844564 2808844564 IN IP4 biloxi.example.com s = c = IN IP4 biloxi.example.com t = 0 0

       m = audio 20000 RTP / AVP 97
       a = rtpmap：97 iLBC / 8000
       m =ビデオ20002RTP / AVP 97
       a = rtpmap：97 H261 / 90000
        
RFC 4961は対称RTPを実行する方法を指定していますが、これはRTPのその後の拡張であり、ボブはアリスがRFC 4961をサポートしていると想定できません. これは、アリスが10000または10002とは異なるポートからRTPを送信している可能性があることを意味します. エフェメラルポートからRTPを送信します. ボブのエンドポイントがRTPパケットを受信した場合、パケットがビデオまたはオーディオコーデックに渡されるかどうかをボブが知る唯一の方法は、受信したポートを確認することです. これにより、一部のSDP実装では、ポート番号をインデックスとして使用して、SDP内の正しい「m =」行を見つけるようになりました. これは、各「m」=セクションに異なるポート番号が含まれているためです. その結果、対称RTPとICEをサポートする一部の実装では、SDPデータ構造が引き続き使用されます. SDPには、次のような同じポートを持つ「m =」セクションがあります. 

SDPオファー

v = 0 o = alice 2890844526 2890844526 IN IP4 atlanta.example.com s = c = IN IP4 atlanta.example.com t = 0 0

       m = audio 10000 RTP / AVP 97
       a = rtpmap：97 iLBC / 8000
       m =ビデオ10000RTP / AVP 98
       a = rtpmap：98 H261 / 90000
        
2番目の「m =」セクションは最初の行と同じポートを持っているため、SDPエラーと見なされます. 

A.2. ポート番号値ゼロの使用
オファーまたはアンサーでは、「m =」セクションで指定されたメディアは、ポート番号の値をゼロに設定することで無効化/拒否できます. これは、たとえば、SDP方向属性を使用する場合とは異なります. この場合、関連する「m =」セクションにSDPの「非アクティブ」属性が示されていても、RTCPトラフィックは継続します. 

BUNDLEグループに関連付けられた各「m =」セクションに異なるポート値が含まれ、それらのポート値の1つがBUNDLEアドレスに使用される場合：BUNDLEグループに関連付けられたポート：エンドポイントが無効化/拒否したい場合に問題が発生しますポート値をゼロに設定することにより、そのポートに関連付けられた「m =」セクション. その後、「m =」セクションには、BUNDLE address：portに使用されるポート値は含まれません. さらに、「m =」セクションに関連付けられたICE候補は、BUNDLE address：portにも使用されるため、どうなるかは不明です. 

A.3. B2BUAとプロキシの相互運用性
一部のバックツーバックユーザーエージェントは、着信コールレッグにB2BUAが理解できないSDP属性が含まれている場合でも、B2BUAが発信コールレッグのオファーでそのSDP属性を生成するモードで設定される場合があります. RFC3605で定義されているSDPの「rtcp」属性を理解していなかったがこのように動作したB2BUAについて考えてみます. さらに、B2BUAは、5分間RTCPが表示されなかったすべてのコールを切断するように構成されていると想定します. この場合、B2BUAが次のようなオファーを受け取った場合：

SDPオファー

v = 0 o = alice 2890844526 2890844526 IN IP4 atlanta.example.com s = c = IN IP4 atlanta.example.com t = 0 0

       m = audio 49170 RTP / AVP 0
       a = rtcp：53020
        
ポート49171でRTCPを探しますが、RTCPがポート53020にあるため、何も表示されず、5分後に通話が切断されます. 同様に、BUNDLEを理解していないが、それをオファーに入れているB2BUAは、間違ったポートでメディアを探して、コールを切断している可能性があります. 理解できない機能を備えたオファーを生成したB2BUAは、仕様に準拠していないことに注意してください. 

A.3.1. トラフィックポリシング
仲介者は、SDP本体を変更したり、SIPダイアログを終了したりしないという意味で、B2BUAとして機能しない場合があります. ただし、トラフィックゲーティング機能を制御し、トラフィックポリシングルールを設定するために、SDP情報（IPアドレスやポートなど）を使用する場合があります. SDPから取得したポートでメディアが送受信されない場合に、セッションの終了をトリガーするルールが存在する場合があります. これは通常、セッションがすでに確立されて進行中の場合に発生します. 

A.3.2. 帯域幅の割り当て
仲介者は、SDP本体を変更したり、SIPダイアログを終了したりしないという意味で、B2BUAとして機能しない場合があります. ただし、帯域幅割り当て機能を制御するために、SDP情報（コーデックやメディアタイプなど）を使用する場合があります. 帯域幅の割り当ては「m =」セクションごとに行われます. つまり、すべての「m =」セクションで指定されたメディアがその帯域幅を使用しようとすると、十分ではない可能性があります. それは単に悪いユーザーエクスペリエンスまたは通話の終了につながる可能性があります. 

A.4. 候補者の集まり
ICEを使用する場合は、ポートごとに候補を集める必要があります. これには、NATペーシング要件のため、余分な「m =」セクションごとに約20ミリ秒余分にかかります. 影響を最小限に抑えるためにWebページを読み込んでいる間など、この収集のすべてを他のものとオーバーラップさせることができます. クライアントが「m =」回線の1つに対してNAT（TURN）またはSTUN ICE候補の周りのリレーを使用してトラバーサルを生成するだけの場合は、Trickle ICE [RFC8838]を使用して、残りの「 m = "セクション、それはそれを行う可能性があり、追加の収集時間を必要としません. 

一度にたくさんのTURN割り当てを取得するためにTURN拡張機能を提案する人もいます. これは単一のSTUN結果のみを提供するため、もう一方の端がBU​​NDLEをサポートしていなかった場合、TURNサーバーの使用量が増える可能性がありますが、両側がBUNDLEをサポートし、フォールバックする場合は迅速になります. 他の場合の成功した呼び出し. 

謝辞

バンドルされたメディアをネゴシエートするためのSDPグループ化拡張機能の使用法は、HaraldAlvestrandとCullenJenningsによって提案された同様の代替案に基づいています. このドキュメントで説明されているBUNDLE拡張機能は、さまざまな代替案に基づいており、それらの代替案からテキスト（SDPの例など）が借用されています（場合によっては変更されています）. 

SDPの例も、Alvestrand提案の例から変更されたバージョンです. 

Paul Kyzivat、Martin Thomson、Flemming Andreasen、Thomas Stach、AriKeränen、Adam Roach、Christian Groves、Roman Shpount、Suhas Nandakumar、Nils Ohlmeier、Jens Guballa、Raju Makaraju、Justin Uberti、Taylor Brandstetter、Byron Campen、EricRescorlaに感謝します. テキストを読み、有用なフィードバックを提供するため. 

RTP / RTCPストリームの関連付けに関するセクションのテキストを提供してくれた、Bernard Aboba、Peter Thatcher、Justin Uberti、およびMagnusWesterlundに感謝します. 

RTP / RTCP手順に関するヘルプとテキストを提供してくれたMagnusWesterlund、Colin Perkins、およびJonathanLennoxに感謝します. 

Sec-Dirレビューを実施してくれたCharlieKaufmanに感謝します. 

Gen-ARTレビューを実行してくれたLindaDunbarに感謝します. 

数え切れないほどのドキュメント編集に音楽を提供してくれたSpotifyに感謝します. 

著者の住所

Christer Holmberg Ericsson Hirsalantie 11 FI-02420Jorvasフィンランド

   Eメール：christer.holmberg@ericsson.com
        
Harald Tveit Alvestrand Google Kungsbron 2SE-11122ストックホルムスウェーデン

   メール：harald@alvestrand.no
        
Cullen Jennings Cisco 400 3rd Avenue SW、Suite 350 Calgary AB T2P 4H2 Canada

   メール：fluffy@iii.ca
        