{
  "title": {
    "text": "RFC 8656: Traversal Using Relays around NAT (TURN): Relay Extensions to Session Traversal Utilities for NAT (STUN)"
  },
  "number": 8656,
  "created_at": "2023-03-19 23:40:27.499600+09:00",
  "updated_by": "",
  "contents": [
    {
      "indent": 0,
      "text": "Peer A\n                                    Server-Reflexive    +---------+\n                                    Transport Address   |         |\n                                    192.0.2.150:32102   |         |\n                                        |              /|         |\n                      TURN              |            / ^|  Peer A |\n   Client's           Server            |           /  ||         |\n   Host Transport     Transport         |         //   ||         |\n   Address            Address           |       //     |+---------+\n198.51.100.2:49721  192.0.2.15:3478     |+-+  //     Peer A\n           |            |               ||N| /       Host Transport\n           |   +-+      |               ||A|/        Address\n           |   | |      |               v|T|     203.0.113.2:49582\n           |   | |      |               /+-+\n+---------+|   | |      |+---------+   /              +---------+\n|         ||   |N|      ||         | //               |         |\n| TURN    |v   | |      v| TURN    |/                 |         |\n| Client  |----|A|-------| Server  |------------------|  Peer B |\n|         |    | |^      |         |^                ^|         |\n|         |    |T||      |         ||                ||         |\n+---------+    | ||      +---------+|                |+---------+\n               | ||                 |                |\n               | ||                 |                |\n               +-+|                 |                |\n                  |                 |                |\n                  |                 |                |\n         Client's                   |             Peer B\n         Server-Reflexive     Relayed             Transport\n         Transport Address    Transport Address   Address\n         192.0.2.1:7000       192.0.2.15:50000    192.0.2.210:49191\nTURN                                 TURN          Peer         Peer\nclient                               server         A            B\n  |-- Allocate request --------------->|            |            |\n  |   (invalid or missing credentials) |            |            |\n  |                                    |            |            |\n  |<--------------- Allocate failure --|            |            |\n  |              (401 Unauthenticated) |            |            |\n  |                                    |            |            |\n  |-- Allocate request --------------->|            |            |\n  |               (valid credentials)  |            |            |\n  |                                    |            |            |\n  |<---------- Allocate success resp --|            |            |\n  |            (192.0.2.15:50000)      |            |            |\n  //                                   //           //           //\n  |                                    |            |            |\n  |-- Refresh request ---------------->|            |            |\n  |                                    |            |            |\n  |<----------- Refresh success resp --|            |            |\n  |                                    |            |            |",
      "raw": true
    },
    {
      "indent": 0,
      "text": "TURN                                TURN           Peer          Peer\nclient                              server          A             B\n  |                                   |             |             |\n  |-- CreatePermission req (Peer A) ->|             |             |\n  |<- CreatePermission success resp --|             |             |\n  |                                   |             |             |\n  |--- Send ind (Peer A)------------->|             |             |\n  |                                   |=== data ===>|             |\n  |                                   |             |             |\n  |                                   |<== data ====|             |\n  |<------------- Data ind (Peer A) --|             |             |\n  |                                   |             |             |\n  |                                   |             |             |\n  |--- Send ind (Peer B)------------->|             |             |\n  |                                   | dropped     |             |\n  |                                   |             |             |\n  |                                   |<== data ==================|\n  |                           dropped |             |             |\n  |                                   |             |             |",
      "raw": true
    },
    {
      "indent": 0,
      "text": "TURN                                TURN           Peer          Peer\nclient                              server          A             B\n  |                                   |             |             |\n  |-- ChannelBind req --------------->|             |             |\n  | (Peer A to 0x4001)                |             |             |\n  |                                   |             |             |\n  |<---------- ChannelBind succ resp -|             |             |\n  |                                   |             |             |\n  |-- (0x4001) data ----------------->|             |             |\n  |                                   |=== data ===>|             |\n  |                                   |             |             |\n  |                                   |<== data ====|             |\n  |<------------------ (0x4001) data -|             |             |\n  |                                   |             |             |\n  |--- Send ind (Peer A)------------->|             |             |\n  |                                   |=== data ===>|             |\n  |                                   |             |             |\n  |                                   |<== data ====|             |\n  |<------------------ (0x4001) data -|             |             |\n  |                                   |             |             |",
      "raw": true
    },
    {
      "indent": 0,
      "text": " 0                   1                   2                   3\n 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|         Channel Number        |            Length             |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|                                                               |\n/                       Application Data                        /\n/                                                               /\n|                                                               |\n|                               +-------------------------------+\n|                               |\n+-------------------------------+\n 0                   1                   2                   3\n 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|        Channel Number         |         RFFU = 0              |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+",
      "raw": true
    },
    {
      "indent": 0,
      "text": " 0                   1                   2                   3\n 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|     Family    |            Reserved                           |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+",
      "raw": true
    },
    {
      "indent": 0,
      "text": "   0\n   0 1 2 3 4 5 6 7\n  +-+-+-+-+-+-+-+-+\n  |R|    RFFU     |\n  +-+-+-+-+-+-+-+-+\n 0                   1                   2                   3\n 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|    Protocol   |                    RFFU                       |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+",
      "raw": true
    },
    {
      "indent": 3,
      "text": " 0                   1                   2                   3\n 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|  Family       |    Reserved             |Class|     Number    |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|      Reason Phrase (variable)                                ..\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+",
      "raw": true
    },
    {
      "indent": 3,
      "text": " 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|  Reserved                     |  ICMP Type  |  ICMP Code      |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|                          Error Data                           |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+",
      "raw": true
    },
    {
      "indent": 0,
      "text": "TURN                                 TURN          Peer         Peer\nclient                               server         A            B\n  |                                    |            |            |\n  |--- Allocate request -------------->|            |            |\n  |    Transaction-Id=0xA56250D3F17ABE679422DE85    |            |\n  |    SOFTWARE=\"Example client, version 1.03\"      |            |\n  |    LIFETIME=3600 (1 hour)          |            |            |\n  |    REQUESTED-TRANSPORT=17 (UDP)    |            |            |\n  |    DONT-FRAGMENT                   |            |            |\n  |                                    |            |            |\n  |<-- Allocate error response --------|            |            |\n  |    Transaction-Id=0xA56250D3F17ABE679422DE85    |            |\n  |    SOFTWARE=\"Example server, version 1.17\"      |            |\n  |    ERROR-CODE=401 (Unauthorized)   |            |            |\n  |    REALM=\"example.com\"             |            |            |\n  |    NONCE=\"obMatJos2gAAAadl7W7PeDU4hKE72jda\"     |            |\n  |    PASSWORD-ALGORITHMS=MD5 and SHA256           |            |\n  |                                    |            |            |\n  |--- Allocate request -------------->|            |            |\n  |    Transaction-Id=0xC271E932AD7446A32C234492    |            |\n  |    SOFTWARE=\"Example client 1.03\"  |            |            |\n  |    LIFETIME=3600 (1 hour)          |            |            |\n  |    REQUESTED-TRANSPORT=17 (UDP)    |            |            |\n  |    DONT-FRAGMENT                   |            |            |\n  |    USERNAME=\"George\"               |            |            |\n  |    REALM=\"example.com\"             |            |            |\n  |    NONCE=\"obMatJos2gAAAadl7W7PeDU4hKE72jda\"     |            |\n  |    PASSWORD-ALGORITHMS=MD5 and SHA256           |            |\n  |    PASSWORD-ALGORITHM=SHA256       |            |            |\n  |    MESSAGE-INTEGRITY=...           |            |            |\n  |    MESSAGE-INTEGRITY-SHA256=...    |            |            |\n  |                                    |            |            |\n  |<-- Allocate success response ------|            |            |\n  |    Transaction-Id=0xC271E932AD7446A32C234492    |            |\n  |    SOFTWARE=\"Example server, version 1.17\"      |            |\n  |    LIFETIME=1200 (20 minutes)      |            |            |\n  |    XOR-RELAYED-ADDRESS=192.0.2.15:50000         |            |\n  |    XOR-MAPPED-ADDRESS=192.0.2.1:7000            |            |\n  |    MESSAGE-INTEGRITY-SHA256=...    |            |            |",
      "raw": true
    },
    {
      "indent": 0,
      "text": "TURN                                 TURN          Peer         Peer\nclient                               server         A            B\n  |--- CreatePermission request ------>|            |            |\n  |    Transaction-Id=0xE5913A8F460956CA277D3319    |            |\n  |    XOR-PEER-ADDRESS=192.0.2.150:0  |            |            |\n  |    USERNAME=\"George\"               |            |            |\n  |    REALM=\"example.com\"             |            |            |\n  |    NONCE=\"obMatJos2gAAAadl7W7PeDU4hKE72jda\"     |            |\n  |    PASSWORD-ALGORITHMS=MD5 and SHA256           |            |\n  |    PASSWORD-ALGORITHM=SHA256       |            |            |\n  |    MESSAGE-INTEGRITY-SHA256=...    |            |            |\n  |                                    |            |            |\n  |<-- CreatePermission success resp.--|            |            |\n  |    Transaction-Id=0xE5913A8F460956CA277D3319    |            |\n  |    MESSAGE-INTEGRITY-SHA256=...    |            |            |",
      "raw": true
    },
    {
      "indent": 0,
      "text": "TURN                                 TURN          Peer         Peer\nclient                               server         A            B\n  |--- Send indication --------------->|            |            |\n  |    Transaction-Id=0x1278E9ACA2711637EF7D3328    |            |\n  |    XOR-PEER-ADDRESS=192.0.2.150:32102           |            |\n  |    DONT-FRAGMENT                   |            |            |\n  |    DATA=...                        |            |            |\n  |                                    |- UDP dgm ->|            |\n  |                                    | data=...   |            |\n  |                                    |            |            |\n  |                                    |<- UDP dgm -|            |\n  |                                    |  data=...  |            |\n  |<-- Data indication ----------------|            |            |\n  |    Transaction-Id=0x8231AE8F9242DA9FF287FEFF    |            |\n  |    XOR-PEER-ADDRESS=192.0.2.150:32102           |            |\n  |    DATA=...                        |            |            |",
      "raw": true
    },
    {
      "indent": 0,
      "text": "TURN                                 TURN          Peer          Peer\nclient                               server         A             B\n  |--- ChannelBind request ----------->|            |             |\n  |    Transaction-Id=0x6490D3BC175AFF3D84513212    |             |\n  |    CHANNEL-NUMBER=0x4000           |            |             |\n  |    XOR-PEER-ADDRESS=192.0.2.210:49191           |             |\n  |    USERNAME=\"George\"               |            |             |\n  |    REALM=\"example.com\"             |            |             |\n  |    NONCE=\"obMatJos2gAAAadl7W7PeDU4hKE72jda\"     |             |\n  |    PASSWORD-ALGORITHMS=MD5 and SHA256           |             |\n  |    PASSWORD-ALGORITHM=SHA256       |            |             |\n  |    MESSAGE-INTEGRITY-SHA256=...    |            |             |\n  |                                    |            |             |\n  |<-- ChannelBind success response ---|            |             |\n  |    Transaction-Id=0x6490D3BC175AFF3D84513212    |             |\n  |    MESSAGE-INTEGRITY-SHA256=...    |            |             |",
      "raw": true
    },
    {
      "indent": 0,
      "text": "TURN                                TURN           Peer          Peer\nclient                              server          A             B\n  |--- ChannelData ------------------>|             |             |\n  |    Channel-number=0x4000          |--- UDP datagram --------->|\n  |    Data=...                       |    Data=...               |\n  |                                   |             |             |\n  |                                   |<-- UDP datagram ----------|\n  |                                   |    Data=... |             |\n  |<-- ChannelData -------------------|             |             |\n  |    Channel-number=0x4000          |             |             |\n  |    Data=...                       |             |             |",
      "raw": true
    },
    {
      "indent": 0,
      "text": "TURN                                 TURN          Peer         Peer\nclient                               server         A            B\n  |--- ChannelBind request ----------->|            |            |\n  |    Transaction-Id=0xE5913A8F46091637EF7D3328    |            |\n  |    CHANNEL-NUMBER=0x4000           |            |            |\n  |    XOR-PEER-ADDRESS=192.0.2.210:49191           |            |\n  |    USERNAME=\"George\"               |            |            |\n  |    REALM=\"example.com\"             |            |            |\n  |    NONCE=\"obMatJos2gAAAadl7W7PeDU4hKE72jda\"     |            |\n  |    PASSWORD-ALGORITHMS=MD5 and SHA256           |            |\n  |    PASSWORD-ALGORITHM=SHA256       |            |            |\n  |    MESSAGE-INTEGRITY-SHA256=...    |            |            |\n  |                                    |            |            |\n  |<-- ChannelBind success response ---|            |            |\n  |    Transaction-Id=0xE5913A8F46091637EF7D3328    |            |\n  |    MESSAGE-INTEGRITY-SHA256=...    |            |            |",
      "raw": true
    },
    {
      "indent": 0,
      "text": "TURN                                 TURN          Peer         Peer\nclient                               server         A            B\n  |--- Refresh request --------------->|            |            |\n  |    Transaction-Id=0x0864B3C27ADE9354B4312414    |            |\n  |    SOFTWARE=\"Example client 1.03\"  |            |            |\n  |    USERNAME=\"George\"               |            |            |\n  |    REALM=\"example.com\"             |            |            |\n  |    NONCE=\"oobMatJos2gAAAadl7W7PeDU4hKE72jda\"    |            |\n  |    PASSWORD-ALGORITHMS=MD5 and SHA256           |            |\n  |    PASSWORD-ALGORITHM=SHA256       |            |            |\n  |    MESSAGE-INTEGRITY-SHA256=...    |            |            |\n  |                                    |            |            |\n  |<-- Refresh error response ---------|            |            |\n  |    Transaction-Id=0x0864B3C27ADE9354B4312414    |            |\n  |    SOFTWARE=\"Example server, version 1.17\"      |            |\n  |    ERROR-CODE=438 (Stale Nonce)    |            |            |\n  |    REALM=\"example.com\"             |            |            |\n  |    NONCE=\"obMatJos2gAAAadl7W7PeDU4hKE72jda\"     |            |\n  |    PASSWORD-ALGORITHMS=MD5 and SHA256           |            |\n  |                                    |            |            |\n  |--- Refresh request --------------->|            |            |\n  |    Transaction-Id=0x427BD3E625A85FC731DC4191    |            |\n  |    SOFTWARE=\"Example client 1.03\"  |            |            |\n  |    USERNAME=\"George\"               |            |            |\n  |    REALM=\"example.com\"             |            |            |\n  |    NONCE=\"obMatJos2gAAAadl7W7PeDU4hKE72jda\"     |            |\n  |    PASSWORD-ALGORITHMS=MD5 and SHA256           |            |\n  |    PASSWORD-ALGORITHM=SHA256       |            |            |\n  |    MESSAGE-INTEGRITY-SHA256=...    |            |            |\n  |                                    |            |            |\n  |<-- Refresh success response -------|            |            |\n  |    Transaction-Id=0x427BD3E625A85FC731DC4191    |            |\n  |    SOFTWARE=\"Example server, version 1.17\"      |            |\n  |    LIFETIME=600 (10 minutes)       |            |            |\n  |    MESSAGE-INTEGRITY=...           |            |            |",
      "raw": true
    },
    {
      "indent": 2,
      "text": "IPv6: src=2001:DB8:1::1 dst=2001:DB8::2 UDP: <ports> TURN: <channel id> IPv6: src=2001:DB8:1::1 dst=2001:DB8::2 UDP: <ports> TURN: <channel id> IPv6: src=2001:DB8:1::1 dst=2001:DB8::2 UDP: <ports> TURN: <channel id> ..."
    }
  ]
}